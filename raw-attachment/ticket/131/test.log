import fipy.solvers.test ... ok
import fipy.models.test ... ok
import fipy.terms.test ... ok
import fipy.tools.test ... ok
import fipy.meshes.numMesh.test ... ok
import fipy.variables.test ... ok
import fipy.viewers.test ... ok
import fipy.boundaryConditions.test ... ok
import fipy.solvers.linearScipyGMRESSolver ... ok
import fipy.solvers.linearScipyCGSolver ... ok
Doctest: fipy.solvers.linearScipyGMRESSolver.LinearScipyGMRESSolver._solve ... FAIL
Doctest: fipy.solvers.linearScipyCGSolver.LinearScipyCGSolver._solve ... FAIL
import fipy.models.levelSet.test ... ok
import fipy.models.levelSet.electroChem.test ... ok
import fipy.models.levelSet.advection.advectionTerm ... ok
import fipy.models.levelSet.advection.higherOrderAdvectionTerm ... ok
import fipy.models.levelSet.distanceFunction.distanceVariable ... ok
import fipy.models.levelSet.surfactant.surfactantVariable ... ok
import fipy.models.levelSet.distanceFunction.levelSetDiffusionVariable ... ok
import fipy.models.levelSet.surfactant.adsorbingSurfactantEquation ... ok
import fipy.models.levelSet.surfactant.convectionCoeff ... ok
import fipy.models.levelSet.electroChem.metalIonSourceVariable ... ok
import fipy.models.levelSet.electroChem.metalIonDiffusionEquation ... ok
import fipy.models.levelSet.electroChem.gapFillMesh ... ok
Doctest: fipy.models.levelSet.electroChem.metalIonSourceVariable._MetalIonSourceVariable ... ok
Doctest: fipy.models.levelSet.electroChem.metalIonDiffusionEquation.buildMetalIonDiffusionEquation ... FAIL
Doctest: fipy.models.levelSet.electroChem.gapFillMesh.GapFillMesh ... sh: gmsh: command not found
FAIL
Doctest: fipy.models.levelSet.electroChem.gapFillMesh.TrenchMesh ... sh: gmsh: command not found
FAIL
Doctest: fipy.models.levelSet.advection.advectionTerm._AdvectionTerm ... ok
Doctest: fipy.models.levelSet.advection.higherOrderAdvectionTerm._HigherOrderAdvectionTerm ... ok
Doctest: fipy.models.levelSet.distanceFunction.distanceVariable.DistanceVariable ... ok
Doctest: fipy.models.levelSet.distanceFunction.distanceVariable.DistanceVariable._getCellInterfaceFlag ... ok
Doctest: fipy.models.levelSet.distanceFunction.distanceVariable.DistanceVariable._getCellInterfaceNormals ... ok
Doctest: fipy.models.levelSet.distanceFunction.distanceVariable.DistanceVariable._getCellValueOverFaces ... ok
Doctest: fipy.models.levelSet.distanceFunction.distanceVariable.DistanceVariable._getInterfaceFlag ... ok
Doctest: fipy.models.levelSet.distanceFunction.distanceVariable.DistanceVariable._getInterfaceNormals ... ok
Doctest: fipy.models.levelSet.distanceFunction.distanceVariable.DistanceVariable._getLevelSetNormals ... ok
Doctest: fipy.models.levelSet.distanceFunction.distanceVariable.DistanceVariable.getCellInterfaceAreas ... ok
Doctest: fipy.models.levelSet.surfactant.surfactantVariable.SurfactantVariable.__init__ ... ok
Doctest: fipy.models.levelSet.distanceFunction.levelSetDiffusionVariable._LevelSetDiffusionVariable ... ok
Doctest: fipy.models.levelSet.surfactant.adsorbingSurfactantEquation.AdsorbingSurfactantEquation ... FAIL
Doctest: fipy.models.levelSet.surfactant.convectionCoeff._ConvectionCoeff.__init__ ... ok
import fipy.terms.cellTerm ... ok
import fipy.terms.diffusionTerm ... ok
import fipy.terms.term ... ok
import fipy.terms.convectionTerm ... ok
import fipy.terms.transientTerm ... ok
import fipy.terms.powerLawConvectionTerm ... ok
import fipy.terms.exponentialConvectionTerm ... ok
Doctest: fipy.terms.cellTerm.CellTerm._test ... ok
Doctest: fipy.terms.diffusionTerm.DiffusionTerm.__neg__ ... ok
Doctest: fipy.terms.diffusionTerm.DiffusionTerm._test ... FAIL
Doctest: fipy.terms.term.Term.__eq__ ... ok
Doctest: fipy.terms.term.Term.__neg__ ... ok
Doctest: fipy.terms.term.Term.__pos__ ... ok
Doctest: fipy.terms.term.Term.__radd__ ... ok
Doctest: fipy.terms.term.Term.__repr__ ... ok
Doctest: fipy.terms.term.Term.__rsub__ ... ok
Doctest: fipy.terms.term.Term.__sub__ ... ok
Doctest: fipy.terms.convectionTerm.ConvectionTerm.__init__ ... ok
Doctest: fipy.terms.convectionTerm.ConvectionTerm.__neg__ ... ok
Doctest: fipy.terms.transientTerm.TransientTerm ... ok
Doctest: fipy.terms.powerLawConvectionTerm.PowerLawConvectionTerm._Alpha._calcValuePy ... ok
Doctest: fipy.terms.exponentialConvectionTerm.ExponentialConvectionTerm._Alpha._calcValue ... ok
import fipy.tools.sparseMatrix ... ok
import fipy.tools.dimensions.physicalField ... ok
import fipy.tools.numerix ... ok
import fipy.tools.dump ... ok
import fipy.tools.vector ... ok
Doctest: fipy.tools.sparseMatrix._SparseIdentityMatrix.__init__ ... ok
Doctest: fipy.tools.sparseMatrix._SparseMatrix.__mul__ ... FAIL
Doctest: fipy.tools.sparseMatrix._SparseMatrix.__neg__ ... ok
Doctest: fipy.tools.sparseMatrix._SparseMatrix.__radd__ ... ok
Doctest: fipy.tools.sparseMatrix._SparseMatrix.addAt ... ok
Doctest: fipy.tools.sparseMatrix._SparseMatrix.put ... ok
Doctest: fipy.tools.sparseMatrix._SparseMatrix.putDiagonal ... ok
Doctest: fipy.tools.dimensions.physicalField.PhysicalField.__abs__ ... ok
Doctest: fipy.tools.dimensions.physicalField.PhysicalField.__array__ ... ok
Doctest: fipy.tools.dimensions.physicalField.PhysicalField.__div__ ... ok
Doctest: fipy.tools.dimensions.physicalField.PhysicalField.__float__ ... ok
Doctest: fipy.tools.dimensions.physicalField.PhysicalField.__getitem__ ... ok
Doctest: fipy.tools.dimensions.physicalField.PhysicalField.__gt__ ... ok
Doctest: fipy.tools.dimensions.physicalField.PhysicalField.__init__ ... ok
Doctest: fipy.tools.dimensions.physicalField.PhysicalField.__mod__ ... ok
Doctest: fipy.tools.dimensions.physicalField.PhysicalField.__neg__ ... ok
Doctest: fipy.tools.dimensions.physicalField.PhysicalField.__pow__ ... ok
Doctest: fipy.tools.dimensions.physicalField.PhysicalField.__radd__ ... ok
Doctest: fipy.tools.dimensions.physicalField.PhysicalField.__repr__ ... ok
Doctest: fipy.tools.dimensions.physicalField.PhysicalField.__rmul__ ... ok
Doctest: fipy.tools.dimensions.physicalField.PhysicalField.__setitem__ ... ok
Doctest: fipy.tools.dimensions.physicalField.PhysicalField.__str__ ... ok
Doctest: fipy.tools.dimensions.physicalField.PhysicalField.__sub__ ... ok
Doctest: fipy.tools.dimensions.physicalField.PhysicalField.arccos ... ok
Doctest: fipy.tools.dimensions.physicalField.PhysicalField.arccosh ... ok
Doctest: fipy.tools.dimensions.physicalField.PhysicalField.arcsin ... ok
Doctest: fipy.tools.dimensions.physicalField.PhysicalField.arctan ... ok
Doctest: fipy.tools.dimensions.physicalField.PhysicalField.arctan2 ... ok
Doctest: fipy.tools.dimensions.physicalField.PhysicalField.arctanh ... ok
Doctest: fipy.tools.dimensions.physicalField.PhysicalField.ceil ... ok
Doctest: fipy.tools.dimensions.physicalField.PhysicalField.conjugate ... ok
Doctest: fipy.tools.dimensions.physicalField.PhysicalField.convertToUnit ... ok
Doctest: fipy.tools.dimensions.physicalField.PhysicalField.copy ... ok
Doctest: fipy.tools.dimensions.physicalField.PhysicalField.cos ... ok
Doctest: fipy.tools.dimensions.physicalField.PhysicalField.cosh ... ok
Doctest: fipy.tools.dimensions.physicalField.PhysicalField.dot ... ok
Doctest: fipy.tools.dimensions.physicalField.PhysicalField.floor ... ok
Doctest: fipy.tools.dimensions.physicalField.PhysicalField.getNumericValue ... ok
Doctest: fipy.tools.dimensions.physicalField.PhysicalField.getUnit ... ok
Doctest: fipy.tools.dimensions.physicalField.PhysicalField.inBaseUnits ... ok
Doctest: fipy.tools.dimensions.physicalField.PhysicalField.inSIUnits ... ok
Doctest: fipy.tools.dimensions.physicalField.PhysicalField.inUnitsOf ... ok
Doctest: fipy.tools.dimensions.physicalField.PhysicalField.log ... ok
Doctest: fipy.tools.dimensions.physicalField.PhysicalField.log10 ... ok
Doctest: fipy.tools.dimensions.physicalField.PhysicalField.put ... ok
Doctest: fipy.tools.dimensions.physicalField.PhysicalField.reshape ... ok
Doctest: fipy.tools.dimensions.physicalField.PhysicalField.sin ... ok
Doctest: fipy.tools.dimensions.physicalField.PhysicalField.sinh ... ok
Doctest: fipy.tools.dimensions.physicalField.PhysicalField.sqrt ... ok
Doctest: fipy.tools.dimensions.physicalField.PhysicalField.sum ... ok
Doctest: fipy.tools.dimensions.physicalField.PhysicalField.take ... ok
Doctest: fipy.tools.dimensions.physicalField.PhysicalField.tan ... ok
Doctest: fipy.tools.dimensions.physicalField.PhysicalField.tanh ... ok
Doctest: fipy.tools.dimensions.physicalField.PhysicalField.tostring ... ok
Doctest: fipy.tools.dimensions.physicalField.PhysicalUnit.__cmp__ ... ok
Doctest: fipy.tools.dimensions.physicalField.PhysicalUnit.__div__ ... ok
Doctest: fipy.tools.dimensions.physicalField.PhysicalUnit.__pow__ ... ok
Doctest: fipy.tools.dimensions.physicalField.PhysicalUnit.__rdiv__ ... ok
Doctest: fipy.tools.dimensions.physicalField.PhysicalUnit.__rmul__ ... ok
Doctest: fipy.tools.dimensions.physicalField.PhysicalUnit.__str__ ... ok
Doctest: fipy.tools.dimensions.physicalField.PhysicalUnit.conversionFactorTo ... ok
Doctest: fipy.tools.dimensions.physicalField.PhysicalUnit.conversionTupleTo ... ok
Doctest: fipy.tools.dimensions.physicalField.PhysicalUnit.isAngle ... ok
Doctest: fipy.tools.dimensions.physicalField.PhysicalUnit.isCompatible ... ok
Doctest: fipy.tools.dimensions.physicalField.PhysicalUnit.isDimensionless ... ok
Doctest: fipy.tools.dimensions.physicalField.PhysicalUnit.isDimensionlessOrAngle ... ok
Doctest: fipy.tools.dimensions.physicalField.PhysicalUnit.name ... ok
Doctest: fipy.tools.dimensions.physicalField.PhysicalUnit.setName ... ok
Doctest: fipy.tools.dimensions.physicalField._Scale ... ok
Doctest: fipy.tools.dimensions.physicalField._findUnit ... ok
Doctest: fipy.tools.numerix ... ok
Doctest: fipy.tools.numerix.arccos ... ok
Doctest: fipy.tools.numerix.arccosh ... ok
Doctest: fipy.tools.numerix.arcsin ... ok
Doctest: fipy.tools.numerix.arcsinh ... ok
Doctest: fipy.tools.numerix.arctan ... ok
Doctest: fipy.tools.numerix.arctan2 ... ok
Doctest: fipy.tools.numerix.arctanh ... ok
Doctest: fipy.tools.numerix.ceil ... ok
Doctest: fipy.tools.numerix.conjugate ... ok
Doctest: fipy.tools.numerix.cos ... ok
Doctest: fipy.tools.numerix.cosh ... ok
Doctest: fipy.tools.numerix.dot ... ok
Doctest: fipy.tools.numerix.floor ... ok
Doctest: fipy.tools.numerix.getShape ... ok
Doctest: fipy.tools.numerix.getTypecode ... ok
Doctest: fipy.tools.numerix.indices ... ok
Doctest: fipy.tools.numerix.log ... ok
Doctest: fipy.tools.numerix.log10 ... ok
Doctest: fipy.tools.numerix.max ... ok
Doctest: fipy.tools.numerix.min ... ok
Doctest: fipy.tools.numerix.put ... /usr/lib/python2.4/site-packages/numpy/core/ma.py:604: UserWarning: Cannot automatically convert masked array to numeric because data
    is masked in one or more locations.
  warnings.warn("Cannot automatically convert masked array to "\
ok
Doctest: fipy.tools.numerix.sin ... ok
Doctest: fipy.tools.numerix.sinh ... ok
Doctest: fipy.tools.numerix.sqrt ... ok
Doctest: fipy.tools.numerix.tan ... ok
Doctest: fipy.tools.numerix.tanh ... ok
Doctest: fipy.tools.numerix.tostring ... ok
Doctest: fipy.tools.dump.write ... ok
Doctest: fipy.tools.vector.prune ... ok
import fipy.meshes.numMesh.mesh ... ok
import fipy.meshes.numMesh.mesh2D ... ok
import fipy.meshes.numMesh.grid1D ... ok
import fipy.meshes.numMesh.grid2D ... ok
import fipy.meshes.numMesh.grid3D ... ok
import fipy.meshes.numMesh.tri2D ... ok
import fipy.meshes.numMesh.gmshImport ... ok
import fipy.meshes.numMesh.refinedMesh ... ok
import fipy.meshes.numMesh.periodicGrid1D ... ok
import fipy.meshes.numMesh.periodicGrid2D ... ok
import fipy.meshes.numMesh.uniformGrid1D ... ok
import fipy.meshes.numMesh.uniformGrid2D ... ok
import fipy.meshes.numMesh.uniformGrid3D ... ok
Doctest: fipy.meshes.numMesh.mesh.Mesh._connectFaces ... ok
Doctest: fipy.meshes.numMesh.mesh.Mesh._test ... ok
Doctest: fipy.meshes.numMesh.mesh2D.Mesh2D._test ... ok
Doctest: fipy.meshes.numMesh.grid1D.Grid1D ... ok
Doctest: fipy.meshes.numMesh.grid2D.Grid2D._test ... ok
Doctest: fipy.meshes.numMesh.grid2D.Grid2D.getFacesBottom ... ok
Doctest: fipy.meshes.numMesh.grid2D.Grid2D.getFacesLeft ... ok
Doctest: fipy.meshes.numMesh.grid2D.Grid2D.getFacesRight ... ok
Doctest: fipy.meshes.numMesh.grid2D.Grid2D.getFacesTop ... ok
Doctest: fipy.meshes.numMesh.grid3D.Grid3D._test ... ok
Doctest: fipy.meshes.numMesh.grid3D.Grid3D.getFacesBack ... ok
Doctest: fipy.meshes.numMesh.grid3D.Grid3D.getFacesBottom ... ok
Doctest: fipy.meshes.numMesh.grid3D.Grid3D.getFacesFront ... ok
Doctest: fipy.meshes.numMesh.grid3D.Grid3D.getFacesLeft ... ok
Doctest: fipy.meshes.numMesh.grid3D.Grid3D.getFacesRight ... ok
Doctest: fipy.meshes.numMesh.grid3D.Grid3D.getFacesTop ... ok
Doctest: fipy.meshes.numMesh.tri2D.Tri2D._test ... ok
Doctest: fipy.meshes.numMesh.gmshImport ... sh: gmsh: command not found
sh: gmsh: command not found
FAIL
Doctest: fipy.meshes.numMesh.gmshImport.GmshImporter3D ... ok
Doctest: fipy.meshes.numMesh.refinedMesh ... ok
Doctest: fipy.meshes.numMesh.periodicGrid1D.PeriodicGrid1D ... ok
Doctest: fipy.meshes.numMesh.periodicGrid2D.PeriodicGrid2D ... ok
Doctest: fipy.meshes.numMesh.uniformGrid1D.UniformGrid1D ... ok
Doctest: fipy.meshes.numMesh.uniformGrid2D.UniformGrid2D._test ... ok
Doctest: fipy.meshes.numMesh.uniformGrid3D.UniformGrid3D._test ... ok
import fipy.variables.vectorCellVariable ... ok
import fipy.variables.vectorFaceVariable ... ok
import fipy.variables.cellVolumeAverageVariable ... ok
import fipy.variables.variable ... ok
import fipy.variables.cellVariable ... ok
import fipy.variables.betaNoiseVariable ... ok
import fipy.variables.exponentialNoiseVariable ... ok
import fipy.variables.gammaNoiseVariable ... ok
import fipy.variables.gaussianNoiseVariable ... ok
import fipy.variables.uniformNoiseVariable ... ok
import fipy.variables.modularVariable ... ok
Doctest: fipy.variables.vectorCellVariable.VectorCellVariable.getArithmeticFaceValue ... ok
Doctest: fipy.variables.vectorCellVariable.VectorCellVariable.getHarmonicFaceValue ... ok
Doctest: fipy.variables.vectorFaceVariable.VectorFaceVariable._testArithmetic ... ok
Doctest: fipy.variables.cellVolumeAverageVariable._CellVolumeAverageVariable ... ok
Doctest: fipy.variables.variable.Variable.__abs__ ... ok
Doctest: fipy.variables.variable.Variable.__and__ ... ok
Doctest: fipy.variables.variable.Variable.__array__ ... FAIL
Doctest: fipy.variables.variable.Variable.__array_wrap__ ... ok
Doctest: fipy.variables.variable.Variable.__call__ ... ok
Doctest: fipy.variables.variable.Variable.__eq__ ... ok
Doctest: fipy.variables.variable.Variable.__ge__ ... ok
Doctest: fipy.variables.variable.Variable.__getitem__ ... ok
Doctest: fipy.variables.variable.Variable.__gt__ ... ok
Doctest: fipy.variables.variable.Variable.__init__ ... ok
Doctest: fipy.variables.variable.Variable.__le__ ... ok
Doctest: fipy.variables.variable.Variable.__lt__ ... ok
Doctest: fipy.variables.variable.Variable.__ne__ ... ok
Doctest: fipy.variables.variable.Variable.__or__ ... ok
Doctest: fipy.variables.variable.Variable._execInline ... ok
Doctest: fipy.variables.variable.Variable._getCstring ... ok
Doctest: fipy.variables.variable.Variable._getOperatorVariableClass ... ok
Doctest: fipy.variables.variable.Variable._getUnaryOperatorVariable ... ok
Doctest: fipy.variables.variable.Variable._take ... ok
Doctest: fipy.variables.variable.Variable._testBinOp ... ok
Doctest: fipy.variables.variable.Variable.allclose ... ok
Doctest: fipy.variables.variable.Variable.copy ... ok
Doctest: fipy.variables.variable.Variable.getShape ... ok
Doctest: fipy.variables.variable.Variable.getTypecode ... ok
Doctest: fipy.variables.variable.Variable.getUnit ... ok
Doctest: fipy.variables.variable.Variable.getValue ... ok
Doctest: fipy.variables.variable.Variable.inBaseUnits ... ok
Doctest: fipy.variables.variable.Variable.inUnitsOf ... ok
Doctest: fipy.variables.variable.Variable.setValue ... ok
Doctest: fipy.variables.variable.Variable.sqrt ... ok
Doctest: fipy.variables.cellVariable.CellVariable ... ok
Doctest: fipy.variables.cellVariable.CellVariable.getArithmeticFaceValue ... ok
Doctest: fipy.variables.cellVariable.CellVariable.getCellVolumeAverage ... ok
Doctest: fipy.variables.cellVariable.CellVariable.getFaceValue ... ok
Doctest: fipy.variables.cellVariable.CellVariable.getHarmonicFaceValue ... ok
Doctest: fipy.variables.cellVariable.CellVariable.getLeastSquaresGrad ... ok
Doctest: fipy.variables.cellVariable.CellVariable.getOld ... ok
Doctest: fipy.variables.cellVariable.CellVariable.setValue ... ok
Doctest: fipy.variables.betaNoiseVariable.BetaNoiseVariable ... ok
Doctest: fipy.variables.exponentialNoiseVariable.ExponentialNoiseVariable ... ok
Doctest: fipy.variables.gammaNoiseVariable.GammaNoiseVariable ... ok
Doctest: fipy.variables.gaussianNoiseVariable.GaussianNoiseVariable ... ok
Doctest: fipy.variables.uniformNoiseVariable.UniformNoiseVariable ... ok
Doctest: fipy.variables.modularVariable.ModularVariable ... ok
Doctest: fipy.variables.modularVariable.ModularVariable._setValue ... ok
Doctest: fipy.variables.modularVariable.ModularVariable.updateOld ... ok
import fipy.viewers.mayaviViewer.lines ... ok
Doctest: fipy.viewers.mayaviViewer.lines._getOrderedLines ... ok
import fipy.boundaryConditions.boundaryCondition ... ok
Doctest: fipy.boundaryConditions.boundaryCondition.BoundaryCondition.__init__ ... ok
import examples.convection.test ... ok
import examples.diffusion.test ... ok
import examples.phase.test ... ok
import examples.elphf.test ... ok
import examples.levelSet.test ... ok
import examples.chemotaxis.test ... ok
import examples.cahnHilliard.test ... ok
import examples.flow.test ... ok
import examples.convection.exponential1D.input ... ok
import examples.convection.exponential1D.tri2Dinput ... ok
import examples.convection.exponential2D.input ... ok
import examples.convection.exponential1DBack.input ... ok
import examples.convection.powerLaw1D.input ... ok
import examples.convection.exponential1DSource.input ... ok
import examples.convection.exponential2D.tri2Dinput ... ok
import examples.convection.exponential1DSource.tri2Dinput ... ok
import examples.convection.powerLaw1D.tri2Dinput ... ok
import examples.convection.advection.inputVanLeerUpwind ... ok
import examples.convection.peclet ... ok
Doctest: examples.convection.exponential1D.input ... FAIL
Doctest: examples.convection.exponential1D.tri2Dinput ... FAIL
Doctest: examples.convection.exponential2D.input ... FAIL
Doctest: examples.convection.exponential1DBack.input ... FAIL
Doctest: examples.convection.powerLaw1D.input ... FAIL
Doctest: examples.convection.exponential1DSource.input ... FAIL
Doctest: examples.convection.exponential2D.tri2Dinput ... FAIL
Doctest: examples.convection.exponential1DSource.tri2Dinput ... FAIL
Doctest: examples.convection.powerLaw1D.tri2Dinput ... FAIL
Doctest: examples.convection.advection.inputVanLeerUpwind ... FAIL
Doctest: examples.convection.peclet ... FAIL
import examples.diffusion.steadyState.test ... ok
import examples.diffusion.explicit.test ... ok
import examples.diffusion.variable.test ... ok
import examples.diffusion.nthOrder.test ... ok
import examples.diffusion.mesh1D ... ok
import examples.diffusion.mesh20x20 ... ok
import examples.diffusion.circle ... ok
import examples.diffusion.electrostatics ... ok
import examples.diffusion.steadyState.mesh1D.tri2Dinput ... ok
import examples.diffusion.steadyState.mesh1D.inputPeriodic ... ok
import examples.diffusion.steadyState.mesh20x20.tri2Dinput ... ok
import examples.diffusion.steadyState.mesh50x50.input ... ok
import examples.diffusion.steadyState.mesh50x50.tri2Dinput ... ok
import examples.diffusion.steadyState.otherMeshes.grid3Dinput ... ok
import examples.diffusion.steadyState.mesh20x20.modifiedMeshInput ... ok
Doctest: examples.diffusion.steadyState.mesh1D.tri2Dinput ... FAIL
Doctest: examples.diffusion.steadyState.mesh1D.inputPeriodic ... FAIL
Doctest: examples.diffusion.steadyState.mesh20x20.tri2Dinput ... FAIL
Doctest: examples.diffusion.steadyState.mesh50x50.input ... FAIL
Doctest: examples.diffusion.steadyState.mesh50x50.tri2Dinput ... FAIL
Doctest: examples.diffusion.steadyState.otherMeshes.grid3Dinput ... FAIL
Doctest: examples.diffusion.steadyState.mesh20x20.modifiedMeshInput ... FAIL
import examples.diffusion.explicit.mesh10.tri2Dinput ... ok
import examples.diffusion.explicit.mesh10.input ... ok
import examples.diffusion.explicit.mesh10.mixedelement ... ok
Doctest: examples.diffusion.explicit.mesh10.tri2Dinput ... FAIL
Doctest: examples.diffusion.explicit.mesh10.input ... FAIL
Doctest: examples.diffusion.explicit.mesh10.mixedelement ... FAIL
import examples.diffusion.variable.tri2Dinput ... ok
Doctest: examples.diffusion.variable.tri2Dinput ... FAIL
import examples.diffusion.nthOrder.input4thOrder1D ... ok
import examples.diffusion.nthOrder.input4thOrder-line ... ok
Doctest: examples.diffusion.nthOrder.input4thOrder1D ... FAIL
Doctest: examples.diffusion.nthOrder.input4thOrder-line ... FAIL
Doctest: examples.diffusion.mesh1D ... FAIL
Doctest: examples.diffusion.mesh20x20 ... FAIL
Doctest: examples.diffusion.circle ... sh: gmsh: command not found
FAIL
Doctest: examples.diffusion.electrostatics ... FAIL
import examples.phase.simple.test ... ok
import examples.phase.anisotropy.test ... ok
import examples.phase.impingement.test ... ok
import examples.phase.missOrientation.test ... ok
import examples.phase.symmetry.test ... ok
import examples.phase.binary ... ok
import examples.phase.quaternary ... ok
import examples.phase.simple.input ... ok
Doctest: examples.phase.simple.input ... FAIL
import examples.phase.anisotropy.input ... ok
Doctest: examples.phase.anisotropy.input ... FAIL
import examples.phase.impingement.mesh40x1.input ... ok
import examples.phase.impingement.mesh20x20.input ... ok
Doctest: examples.phase.impingement.mesh40x1.input ... FAIL
Doctest: examples.phase.impingement.mesh20x20.input ... FAIL
import examples.phase.missOrientation.mesh1D.input ... ok
import examples.phase.missOrientation.circle.input ... ok
import examples.phase.missOrientation.modCircle.input ... ok
Doctest: examples.phase.missOrientation.mesh1D.input ... FAIL
Doctest: examples.phase.missOrientation.circle.input ... FAIL
Doctest: examples.phase.missOrientation.modCircle.input ... FAIL
import examples.phase.symmetry.input ... ok
Doctest: examples.phase.symmetry.input ... ok
Doctest: examples.phase.binary ... FAIL
Doctest: examples.phase.quaternary ... FAIL
import examples.elphf.diffusion.input1D ... ok
import examples.elphf.diffusion.input2D ... ok
import examples.elphf.phase.input1D ... ok
import examples.elphf.phaseDiffusion.input1D ... ok
import examples.elphf.poisson.input1D ... ok
Doctest: examples.elphf.diffusion.input1D ... FAIL
Doctest: examples.elphf.diffusion.input2D ... FAIL
Doctest: examples.elphf.phase.input1D ... FAIL
Doctest: examples.elphf.phaseDiffusion.input1D ... FAIL
Doctest: examples.elphf.poisson.input1D ... FAIL
import examples.levelSet.distanceFunction.test ... ok
import examples.levelSet.advection.test ... ok
import examples.levelSet.surfactant.test ... ok
import examples.levelSet.electroChem.test ... ok
import examples.levelSet.distanceFunction.oneD.input ... ok
import examples.levelSet.distanceFunction.circle.input ... ok
import examples.levelSet.distanceFunction.square.input ... ok
import examples.levelSet.distanceFunction.interior.input ... ok
Doctest: examples.levelSet.distanceFunction.oneD.input ... ok
Doctest: examples.levelSet.distanceFunction.circle.input ... ok
Doctest: examples.levelSet.distanceFunction.square.input ... ok
Doctest: examples.levelSet.distanceFunction.interior.input ... ok
import examples.levelSet.advection.mesh1D.input ... ok
import examples.levelSet.advection.circle.input ... ok
import examples.levelSet.advection.trench.input ... ok
Doctest: examples.levelSet.advection.mesh1D.input ... ok
Doctest: examples.levelSet.advection.circle.input ... ok
Doctest: examples.levelSet.advection.trench.input ... ok
import examples.levelSet.surfactant.inputCircle ... ok
import examples.levelSet.surfactant.inputSquare ... ok
import examples.levelSet.surfactant.expandingCircle ... ok
import examples.levelSet.surfactant.adsorption ... ok
Doctest: examples.levelSet.surfactant.inputCircle ... FAIL
Doctest: examples.levelSet.surfactant.inputSquare ... FAIL
Doctest: examples.levelSet.surfactant.expandingCircle ... FAIL
Doctest: examples.levelSet.surfactant.adsorption ... FAIL
import examples.levelSet.electroChem.inputWriteScriptHowTo ... ok
import examples.levelSet.electroChem.inputSimpleTrenchSystem ... ok
import examples.levelSet.electroChem.inputGold ... ok
import examples.levelSet.electroChem.inputLeveler ... ok
Doctest: examples.levelSet.electroChem.inputWriteScriptHowTo ... FAIL
Doctest: examples.levelSet.electroChem.inputSimpleTrenchSystem ... FAIL
Doctest: examples.levelSet.electroChem.inputGold ... sh: gmsh: command not found
FAIL
Doctest: examples.levelSet.electroChem.inputLeveler ... sh: gmsh: command not found
FAIL
import examples.chemotaxis.input ... ok
import examples.chemotaxis.input2D ... ok
Doctest: examples.chemotaxis.input ... FAIL
Doctest: examples.chemotaxis.input2D ... FAIL
import examples.cahnHilliard.inputTanh1D ... ok
Doctest: examples.cahnHilliard.inputTanh1D ... FAIL
import examples.flow.stokesCavity ... ok
Doctest: examples.flow.stokesCavity ... FAIL

======================================================================
FAIL: Doctest: fipy.solvers.linearScipyGMRESSolver.LinearScipyGMRESSolver._solve
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for fipy.solvers.linearScipyGMRESSolver.LinearScipyGMRESSolver._solve
  File "/home/username/tmp/fipy-current/fipy/solvers/linearScipyGMRESSolver.py", line 71, in _solve

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/fipy/solvers/linearScipyGMRESSolver.py", line 94, in fipy.solvers.linearScipyGMRESSolver.LinearScipyGMRESSolver._solve
Failed example:
    solver._solve(A, x, b)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest fipy.solvers.linearScipyGMRESSolver.LinearScipyGMRESSolver._solve[18]>", line 1, in ?
        solver._solve(A, x, b)
      File "/home/username/tmp/fipy-current/fipy/solvers/linearScipyGMRESSolver.py", line 100, in _solve
        x[:], info = gmres(L,b, x0 = x.copy(), tol = self.tolerance, maxiter = self.iterations)
      File "/usr/lib/python2.4/site-packages/scipy/linalg/iterative.py", line 574, in gmres
        atyp = A.matvec(x).dtype.char
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 350, in matvec
        return self * x
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 227, in __mul__
        self.matrix.matvec(other, y)
    TypeError: argument 1 must be array, not numpy.ndarray
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/fipy/solvers/linearScipyGMRESSolver.py", line 95, in fipy.solvers.linearScipyGMRESSolver.LinearScipyGMRESSolver._solve
Failed example:
    numerix.allclose(x, numerix.arange(N) * dx + dx / 2.)
Expected:
    1
Got:
    False


======================================================================
FAIL: Doctest: fipy.solvers.linearScipyCGSolver.LinearScipyCGSolver._solve
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for fipy.solvers.linearScipyCGSolver.LinearScipyCGSolver._solve
  File "/home/username/tmp/fipy-current/fipy/solvers/linearScipyCGSolver.py", line 70, in _solve

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/fipy/solvers/linearScipyCGSolver.py", line 93, in fipy.solvers.linearScipyCGSolver.LinearScipyCGSolver._solve
Failed example:
    solver._solve(A, x, b)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest fipy.solvers.linearScipyCGSolver.LinearScipyCGSolver._solve[18]>", line 1, in ?
        solver._solve(A, x, b)
      File "/home/username/tmp/fipy-current/fipy/solvers/linearScipyCGSolver.py", line 99, in _solve
        x[:], info = cg(L,b, x0 = x.copy(), tol = self.tolerance, maxiter = self.iterations)
      File "/usr/lib/python2.4/site-packages/scipy/linalg/iterative.py", line 369, in cg
        atyp = A.matvec(x).dtype.char
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 350, in matvec
        return self * x
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 227, in __mul__
        self.matrix.matvec(other, y)
    TypeError: argument 1 must be array, not numpy.ndarray
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/fipy/solvers/linearScipyCGSolver.py", line 94, in fipy.solvers.linearScipyCGSolver.LinearScipyCGSolver._solve
Failed example:
    numerix.allclose(x, numerix.arange(N) * dx + dx / 2.)
Expected:
    1
Got:
    False


======================================================================
FAIL: Doctest: fipy.models.levelSet.electroChem.metalIonDiffusionEquation.buildMetalIonDiffusionEquation
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for fipy.models.levelSet.electroChem.metalIonDiffusionEquation.buildMetalIonDiffusionEquation
  File "/home/username/tmp/fipy-current/fipy/models/levelSet/electroChem/metalIonDiffusionEquation.py", line 58, in buildMetalIonDiffusionEquation

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/fipy/models/levelSet/electroChem/metalIonDiffusionEquation.py", line 123, in fipy.models.levelSet.electroChem.metalIonDiffusionEquation.buildMetalIonDiffusionEquation
Failed example:
    for i in range(10):
        eqn.solve(ionVar, dt = 1000, boundaryConditions = bc)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest fipy.models.levelSet.electroChem.metalIonDiffusionEquation.buildMetalIonDiffusionEquation[16]>", line 2, in ?
        eqn.solve(ionVar, dt = 1000, boundaryConditions = bc)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 66, in _buildMatrix
        termMatrix, termRHSvector = self.term2._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/fipy/models/levelSet/electroChem/metalIonDiffusionEquation.py", line 130, in fipy.models.levelSet.electroChem.metalIonDiffusionEquation.buildMetalIonDiffusionEquation
Failed example:
    numerix.allclose(answer, numerix.array(ionVar))
Expected:
    1
Got:
    False


======================================================================
FAIL: Doctest: fipy.models.levelSet.electroChem.gapFillMesh.GapFillMesh
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for fipy.models.levelSet.electroChem.gapFillMesh.GapFillMesh
  File "/home/username/tmp/fipy-current/fipy/models/levelSet/electroChem/gapFillMesh.py", line 23, in GapFillMesh

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/fipy/models/levelSet/electroChem/gapFillMesh.py", line 30, in fipy.models.levelSet.electroChem.gapFillMesh.GapFillMesh
Failed example:
    mesh = GapFillMesh(transitionRegionHeight = 2.,
                       cellSize = 0.1,
                       desiredFineRegionHeight = 1.,
                       desiredDomainHeight = domainHeight,
                       desiredDomainWidth = 1.)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest fipy.models.levelSet.electroChem.gapFillMesh.GapFillMesh[1]>", line 5, in ?
        desiredDomainWidth = 1.)
      File "/home/username/tmp/fipy-current/fipy/models/levelSet/electroChem/gapFillMesh.py", line 101, in __init__
        transitionMesh = self.buildTransitionMesh(nx, transitionRegionHeight, cellSize) + (0, self.actualFineRegionHeight)
      File "/home/username/tmp/fipy-current/fipy/models/levelSet/electroChem/gapFillMesh.py", line 173, in buildTransitionMesh
        mesh = GmshImporter2D(meshName)
      File "/home/username/tmp/fipy-current/fipy/meshes/numMesh/gmshImport.py", line 394, in __init__
        mesh2D.Mesh2D.__init__(self, **_DataGetter().getData(filename, dimensions = 2, coordDimensions = coordDimensions))
      File "/home/username/tmp/fipy-current/fipy/meshes/numMesh/gmshImport.py", line 263, in getData
        vertexCoords = self._calcVertexCoords(coordDimensions)
      File "/home/username/tmp/fipy-current/fipy/meshes/numMesh/gmshImport.py", line 286, in _calcVertexCoords
        numVertices = int(self.inFile.readline())
    ValueError: invalid literal for int(): 
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/fipy/models/levelSet/electroChem/gapFillMesh.py", line 37, in fipy.models.levelSet.electroChem.gapFillMesh.GapFillMesh
Failed example:
    (f, filename) = dump.write(mesh)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest fipy.models.levelSet.electroChem.gapFillMesh.GapFillMesh[3]>", line 1, in ?
        (f, filename) = dump.write(mesh)
    NameError: name 'mesh' is not defined
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/fipy/models/levelSet/electroChem/gapFillMesh.py", line 38, in fipy.models.levelSet.electroChem.gapFillMesh.GapFillMesh
Failed example:
    mesh = dump.read(filename, f)        
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest fipy.models.levelSet.electroChem.gapFillMesh.GapFillMesh[4]>", line 1, in ?
        mesh = dump.read(filename, f)
    NameError: name 'filename' is not defined
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/fipy/models/levelSet/electroChem/gapFillMesh.py", line 39, in fipy.models.levelSet.electroChem.gapFillMesh.GapFillMesh
Failed example:
    mesh.getNumberOfCells() - len(mesh.getCellIDsAboveFineRegion())
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest fipy.models.levelSet.electroChem.gapFillMesh.GapFillMesh[5]>", line 1, in ?
        mesh.getNumberOfCells() - len(mesh.getCellIDsAboveFineRegion())
    NameError: name 'mesh' is not defined
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/fipy/models/levelSet/electroChem/gapFillMesh.py", line 43, in fipy.models.levelSet.electroChem.gapFillMesh.GapFillMesh
Failed example:
    var = CellVariable(mesh = mesh)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest fipy.models.levelSet.electroChem.gapFillMesh.GapFillMesh[7]>", line 1, in ?
        var = CellVariable(mesh = mesh)
    NameError: name 'mesh' is not defined
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/fipy/models/levelSet/electroChem/gapFillMesh.py", line 49, in fipy.models.levelSet.electroChem.gapFillMesh.GapFillMesh
Failed example:
    eq.solve(var, boundaryConditions = (FixedValue(mesh.getBottomFaces(), 0.),
                                        FixedValue(mesh.getTopFaces(), domainHeight)))
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest fipy.models.levelSet.electroChem.gapFillMesh.GapFillMesh[11]>", line 1, in ?
        eq.solve(var, boundaryConditions = (FixedValue(mesh.getBottomFaces(), 0.),
    NameError: name 'var' is not defined
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/fipy/models/levelSet/electroChem/gapFillMesh.py", line 54, in fipy.models.levelSet.electroChem.gapFillMesh.GapFillMesh
Failed example:
    centers = mesh.getCellCenters()[:,1]
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest fipy.models.levelSet.electroChem.gapFillMesh.GapFillMesh[12]>", line 1, in ?
        centers = mesh.getCellCenters()[:,1]
    NameError: name 'mesh' is not defined
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/fipy/models/levelSet/electroChem/gapFillMesh.py", line 55, in fipy.models.levelSet.electroChem.gapFillMesh.GapFillMesh
Failed example:
    localErrors = (centers - var)**2 / centers**2
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest fipy.models.levelSet.electroChem.gapFillMesh.GapFillMesh[13]>", line 1, in ?
        localErrors = (centers - var)**2 / centers**2
    NameError: name 'centers' is not defined
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/fipy/models/levelSet/electroChem/gapFillMesh.py", line 56, in fipy.models.levelSet.electroChem.gapFillMesh.GapFillMesh
Failed example:
    globalError = numerix.sqrt(numerix.sum(localErrors) / mesh.getNumberOfCells())
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest fipy.models.levelSet.electroChem.gapFillMesh.GapFillMesh[14]>", line 1, in ?
        globalError = numerix.sqrt(numerix.sum(localErrors) / mesh.getNumberOfCells())
    NameError: name 'localErrors' is not defined
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/fipy/models/levelSet/electroChem/gapFillMesh.py", line 57, in fipy.models.levelSet.electroChem.gapFillMesh.GapFillMesh
Failed example:
    argmax = numerix.argmax(localErrors)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest fipy.models.levelSet.electroChem.gapFillMesh.GapFillMesh[15]>", line 1, in ?
        argmax = numerix.argmax(localErrors)
    NameError: name 'localErrors' is not defined
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/fipy/models/levelSet/electroChem/gapFillMesh.py", line 58, in fipy.models.levelSet.electroChem.gapFillMesh.GapFillMesh
Failed example:
    print numerix.sqrt(localErrors[argmax]) < 0.05
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest fipy.models.levelSet.electroChem.gapFillMesh.GapFillMesh[16]>", line 1, in ?
        print numerix.sqrt(localErrors[argmax]) < 0.05
    NameError: name 'localErrors' is not defined
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/fipy/models/levelSet/electroChem/gapFillMesh.py", line 60, in fipy.models.levelSet.electroChem.gapFillMesh.GapFillMesh
Failed example:
    print globalError < 0.02
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest fipy.models.levelSet.electroChem.gapFillMesh.GapFillMesh[17]>", line 1, in ?
        print globalError < 0.02
    NameError: name 'globalError' is not defined


======================================================================
FAIL: Doctest: fipy.models.levelSet.electroChem.gapFillMesh.TrenchMesh
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for fipy.models.levelSet.electroChem.gapFillMesh.TrenchMesh
  File "/home/username/tmp/fipy-current/fipy/models/levelSet/electroChem/gapFillMesh.py", line 193, in TrenchMesh

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/fipy/models/levelSet/electroChem/gapFillMesh.py", line 210, in fipy.models.levelSet.electroChem.gapFillMesh.TrenchMesh
Failed example:
    mesh = TrenchMesh(trenchSpacing = 1e-6,
                      cellSize = cellSize,
                      trenchDepth = trenchDepth,
                      boundaryLayerDepth = boundaryLayerDepth,
                      aspectRatio = 1.)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest fipy.models.levelSet.electroChem.gapFillMesh.TrenchMesh[4]>", line 5, in ?
        aspectRatio = 1.)
      File "/home/username/tmp/fipy-current/fipy/models/levelSet/electroChem/gapFillMesh.py", line 304, in __init__
        transitionRegionHeight = transitionHeight)
      File "/home/username/tmp/fipy-current/fipy/models/levelSet/electroChem/gapFillMesh.py", line 101, in __init__
        transitionMesh = self.buildTransitionMesh(nx, transitionRegionHeight, cellSize) + (0, self.actualFineRegionHeight)
      File "/home/username/tmp/fipy-current/fipy/models/levelSet/electroChem/gapFillMesh.py", line 173, in buildTransitionMesh
        mesh = GmshImporter2D(meshName)
      File "/home/username/tmp/fipy-current/fipy/meshes/numMesh/gmshImport.py", line 394, in __init__
        mesh2D.Mesh2D.__init__(self, **_DataGetter().getData(filename, dimensions = 2, coordDimensions = coordDimensions))
      File "/home/username/tmp/fipy-current/fipy/meshes/numMesh/gmshImport.py", line 263, in getData
        vertexCoords = self._calcVertexCoords(coordDimensions)
      File "/home/username/tmp/fipy-current/fipy/meshes/numMesh/gmshImport.py", line 286, in _calcVertexCoords
        numVertices = int(self.inFile.readline())
    ValueError: invalid literal for int(): 
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/fipy/models/levelSet/electroChem/gapFillMesh.py", line 217, in fipy.models.levelSet.electroChem.gapFillMesh.TrenchMesh
Failed example:
    (f, filename) = dump.write(mesh)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest fipy.models.levelSet.electroChem.gapFillMesh.TrenchMesh[6]>", line 1, in ?
        (f, filename) = dump.write(mesh)
    NameError: name 'mesh' is not defined
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/fipy/models/levelSet/electroChem/gapFillMesh.py", line 218, in fipy.models.levelSet.electroChem.gapFillMesh.TrenchMesh
Failed example:
    mesh = dump.read(filename, f)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest fipy.models.levelSet.electroChem.gapFillMesh.TrenchMesh[7]>", line 1, in ?
        mesh = dump.read(filename, f)
    NameError: name 'filename' is not defined
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/fipy/models/levelSet/electroChem/gapFillMesh.py", line 219, in fipy.models.levelSet.electroChem.gapFillMesh.TrenchMesh
Failed example:
    mesh.getNumberOfCells() - len(numerix.nonzero(mesh.getElectrolyteMask()))        
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest fipy.models.levelSet.electroChem.gapFillMesh.TrenchMesh[8]>", line 1, in ?
        mesh.getNumberOfCells() - len(numerix.nonzero(mesh.getElectrolyteMask()))
    NameError: name 'mesh' is not defined
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/fipy/models/levelSet/electroChem/gapFillMesh.py", line 223, in fipy.models.levelSet.electroChem.gapFillMesh.TrenchMesh
Failed example:
    var = CellVariable(mesh = mesh, value = 0.)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest fipy.models.levelSet.electroChem.gapFillMesh.TrenchMesh[10]>", line 1, in ?
        var = CellVariable(mesh = mesh, value = 0.)
    NameError: name 'mesh' is not defined
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/fipy/models/levelSet/electroChem/gapFillMesh.py", line 229, in fipy.models.levelSet.electroChem.gapFillMesh.TrenchMesh
Failed example:
    eq.solve(var, boundaryConditions = (FixedValue(mesh.getBottomFaces(), 0.),
                                        FixedValue(mesh.getTopFaces(), domainHeight)))
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest fipy.models.levelSet.electroChem.gapFillMesh.TrenchMesh[14]>", line 1, in ?
        eq.solve(var, boundaryConditions = (FixedValue(mesh.getBottomFaces(), 0.),
    NameError: name 'var' is not defined
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/fipy/models/levelSet/electroChem/gapFillMesh.py", line 234, in fipy.models.levelSet.electroChem.gapFillMesh.TrenchMesh
Failed example:
    centers = mesh.getCellCenters()[:,1]
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest fipy.models.levelSet.electroChem.gapFillMesh.TrenchMesh[15]>", line 1, in ?
        centers = mesh.getCellCenters()[:,1]
    NameError: name 'mesh' is not defined
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/fipy/models/levelSet/electroChem/gapFillMesh.py", line 235, in fipy.models.levelSet.electroChem.gapFillMesh.TrenchMesh
Failed example:
    localErrors = (centers - var)**2 / centers**2
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest fipy.models.levelSet.electroChem.gapFillMesh.TrenchMesh[16]>", line 1, in ?
        localErrors = (centers - var)**2 / centers**2
    NameError: name 'centers' is not defined
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/fipy/models/levelSet/electroChem/gapFillMesh.py", line 236, in fipy.models.levelSet.electroChem.gapFillMesh.TrenchMesh
Failed example:
    globalError = numerix.sqrt(numerix.sum(localErrors) / mesh.getNumberOfCells())
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest fipy.models.levelSet.electroChem.gapFillMesh.TrenchMesh[17]>", line 1, in ?
        globalError = numerix.sqrt(numerix.sum(localErrors) / mesh.getNumberOfCells())
    NameError: name 'localErrors' is not defined
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/fipy/models/levelSet/electroChem/gapFillMesh.py", line 237, in fipy.models.levelSet.electroChem.gapFillMesh.TrenchMesh
Failed example:
    argmax = numerix.argmax(localErrors)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest fipy.models.levelSet.electroChem.gapFillMesh.TrenchMesh[18]>", line 1, in ?
        argmax = numerix.argmax(localErrors)
    NameError: name 'localErrors' is not defined
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/fipy/models/levelSet/electroChem/gapFillMesh.py", line 238, in fipy.models.levelSet.electroChem.gapFillMesh.TrenchMesh
Failed example:
    print numerix.sqrt(localErrors[argmax]) < 0.051
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest fipy.models.levelSet.electroChem.gapFillMesh.TrenchMesh[19]>", line 1, in ?
        print numerix.sqrt(localErrors[argmax]) < 0.051
    NameError: name 'localErrors' is not defined
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/fipy/models/levelSet/electroChem/gapFillMesh.py", line 240, in fipy.models.levelSet.electroChem.gapFillMesh.TrenchMesh
Failed example:
    print globalError < 0.02
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest fipy.models.levelSet.electroChem.gapFillMesh.TrenchMesh[20]>", line 1, in ?
        print globalError < 0.02
    NameError: name 'globalError' is not defined


======================================================================
FAIL: Doctest: fipy.models.levelSet.surfactant.adsorbingSurfactantEquation.AdsorbingSurfactantEquation
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for fipy.models.levelSet.surfactant.adsorbingSurfactantEquation.AdsorbingSurfactantEquation
  File "/home/username/tmp/fipy-current/fipy/models/levelSet/surfactant/adsorbingSurfactantEquation.py", line 106, in AdsorbingSurfactantEquation

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/fipy/models/levelSet/surfactant/adsorbingSurfactantEquation.py", line 164, in fipy.models.levelSet.surfactant.adsorbingSurfactantEquation.AdsorbingSurfactantEquation
Failed example:
    eqn.solve(surfactantVar, dt = dt)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest fipy.models.levelSet.surfactant.adsorbingSurfactantEquation.AdsorbingSurfactantEquation[15]>", line 1, in ?
        eqn.solve(surfactantVar, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/models/levelSet/surfactant/adsorbingSurfactantEquation.py", line 369, in solve
        SurfactantEquation.solve(self, var, boundaryConditions = boundaryConditions, solver = solver, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/models/levelSet/surfactant/surfactantEquation.py", line 96, in solve
        solver = solver)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 66, in _buildMatrix
        termMatrix, termRHSvector = self.term2._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/faceTerm.py", line 173, in _buildMatrix
        self._explicitBuildMatrix(var.getOld(), id1, id2, b, weight['explicit'], mesh, boundaryConditions, interiorFaces, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/faceTerm.py", line 100, in _explicitBuildMatrix
        b -= LL * numerix.array(oldArray)
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 227, in __mul__
        self.matrix.matvec(other, y)
    TypeError: argument 1 must be array, not numpy.ndarray
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/fipy/models/levelSet/surfactant/adsorbingSurfactantEquation.py", line 166, in fipy.models.levelSet.surfactant.adsorbingSurfactantEquation.AdsorbingSurfactantEquation
Failed example:
    print numerix.allclose(surfactantVar.getInterfaceVar(), 
                     numerix.array((0, 0, answer, 0, 0)))
Expected:
    1
Got:
    False
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/fipy/models/levelSet/surfactant/adsorbingSurfactantEquation.py", line 212, in fipy.models.levelSet.surfactant.adsorbingSurfactantEquation.AdsorbingSurfactantEquation
Failed example:
    for step in range(totalSteps):
        eqn0.solve(var0, dt = dt)
        eqn1.solve(var1, dt = dt)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest fipy.models.levelSet.surfactant.adsorbingSurfactantEquation.AdsorbingSurfactantEquation[39]>", line 2, in ?
        eqn0.solve(var0, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/models/levelSet/surfactant/adsorbingSurfactantEquation.py", line 369, in solve
        SurfactantEquation.solve(self, var, boundaryConditions = boundaryConditions, solver = solver, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/models/levelSet/surfactant/surfactantEquation.py", line 96, in solve
        solver = solver)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 66, in _buildMatrix
        termMatrix, termRHSvector = self.term2._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/faceTerm.py", line 173, in _buildMatrix
        self._explicitBuildMatrix(var.getOld(), id1, id2, b, weight['explicit'], mesh, boundaryConditions, interiorFaces, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/faceTerm.py", line 100, in _explicitBuildMatrix
        b -= LL * numerix.array(oldArray)
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 227, in __mul__
        self.matrix.matvec(other, y)
    TypeError: argument 1 must be array, not numpy.ndarray
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/fipy/models/levelSet/surfactant/adsorbingSurfactantEquation.py", line 217, in fipy.models.levelSet.surfactant.adsorbingSurfactantEquation.AdsorbingSurfactantEquation
Failed example:
    print numerix.allclose(var0.getInterfaceVar(), 
                     numerix.array((0, 0, answer0, 0, 0)), rtol = 1e-2)
Expected:
    1
Got:
    False
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/fipy/models/levelSet/surfactant/adsorbingSurfactantEquation.py", line 220, in fipy.models.levelSet.surfactant.adsorbingSurfactantEquation.AdsorbingSurfactantEquation
Failed example:
    print numerix.allclose(var1.getInterfaceVar(), 
                     numerix.array((0, 0, answer1, 0, 0)), rtol = 1e-2)
Expected:
    1
Got:
    False
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/fipy/models/levelSet/surfactant/adsorbingSurfactantEquation.py", line 224, in fipy.models.levelSet.surfactant.adsorbingSurfactantEquation.AdsorbingSurfactantEquation
Failed example:
    for step in range(10):
        eqn0.solve(var0, dt = dt)
        eqn1.solve(var1, dt = dt)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest fipy.models.levelSet.surfactant.adsorbingSurfactantEquation.AdsorbingSurfactantEquation[45]>", line 2, in ?
        eqn0.solve(var0, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/models/levelSet/surfactant/adsorbingSurfactantEquation.py", line 369, in solve
        SurfactantEquation.solve(self, var, boundaryConditions = boundaryConditions, solver = solver, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/models/levelSet/surfactant/surfactantEquation.py", line 96, in solve
        solver = solver)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 66, in _buildMatrix
        termMatrix, termRHSvector = self.term2._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/faceTerm.py", line 173, in _buildMatrix
        self._explicitBuildMatrix(var.getOld(), id1, id2, b, weight['explicit'], mesh, boundaryConditions, interiorFaces, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/faceTerm.py", line 100, in _explicitBuildMatrix
        b -= LL * numerix.array(oldArray)
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 227, in __mul__
        self.matrix.matvec(other, y)
    TypeError: argument 1 must be array, not numpy.ndarray
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/fipy/models/levelSet/surfactant/adsorbingSurfactantEquation.py", line 227, in fipy.models.levelSet.surfactant.adsorbingSurfactantEquation.AdsorbingSurfactantEquation
Failed example:
    print var0.getInterfaceVar()[2] + var1.getInterfaceVar()[2]
Expected:
    1.0
Got:
    0.0
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/fipy/models/levelSet/surfactant/adsorbingSurfactantEquation.py", line 243, in fipy.models.levelSet.surfactant.adsorbingSurfactantEquation.AdsorbingSurfactantEquation
Failed example:
    eqn0.solve(var0, dt = dt)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest fipy.models.levelSet.surfactant.adsorbingSurfactantEquation.AdsorbingSurfactantEquation[50]>", line 1, in ?
        eqn0.solve(var0, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/models/levelSet/surfactant/adsorbingSurfactantEquation.py", line 369, in solve
        SurfactantEquation.solve(self, var, boundaryConditions = boundaryConditions, solver = solver, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/models/levelSet/surfactant/surfactantEquation.py", line 96, in solve
        solver = solver)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 66, in _buildMatrix
        termMatrix, termRHSvector = self.term2._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/faceTerm.py", line 173, in _buildMatrix
        self._explicitBuildMatrix(var.getOld(), id1, id2, b, weight['explicit'], mesh, boundaryConditions, interiorFaces, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/faceTerm.py", line 100, in _explicitBuildMatrix
        b -= LL * numerix.array(oldArray)
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 227, in __mul__
        self.matrix.matvec(other, y)
    TypeError: argument 1 must be array, not numpy.ndarray
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/fipy/models/levelSet/surfactant/adsorbingSurfactantEquation.py", line 244, in fipy.models.levelSet.surfactant.adsorbingSurfactantEquation.AdsorbingSurfactantEquation
Failed example:
    eqn0.solve(var0, dt = dt)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest fipy.models.levelSet.surfactant.adsorbingSurfactantEquation.AdsorbingSurfactantEquation[51]>", line 1, in ?
        eqn0.solve(var0, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/models/levelSet/surfactant/adsorbingSurfactantEquation.py", line 369, in solve
        SurfactantEquation.solve(self, var, boundaryConditions = boundaryConditions, solver = solver, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/models/levelSet/surfactant/surfactantEquation.py", line 96, in solve
        solver = solver)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 66, in _buildMatrix
        termMatrix, termRHSvector = self.term2._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/faceTerm.py", line 173, in _buildMatrix
        self._explicitBuildMatrix(var.getOld(), id1, id2, b, weight['explicit'], mesh, boundaryConditions, interiorFaces, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/faceTerm.py", line 100, in _explicitBuildMatrix
        b -= LL * numerix.array(oldArray)
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 227, in __mul__
        self.matrix.matvec(other, y)
    TypeError: argument 1 must be array, not numpy.ndarray
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/fipy/models/levelSet/surfactant/adsorbingSurfactantEquation.py", line 286, in fipy.models.levelSet.surfactant.adsorbingSurfactantEquation.AdsorbingSurfactantEquation
Failed example:
    for i in range(50):
        disVar.calcDistanceFunction()
        extVar.setValue(numerix.array(accVar.getInterfaceVar()))
        disVar.extendVariable(extVar)
        disVar.updateOld()
        advEq.solve(disVar, dt = dt)
        levEq.solve(levVar, dt = dt)
        accEq.solve(accVar, dt = dt)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest fipy.models.levelSet.surfactant.adsorbingSurfactantEquation.AdsorbingSurfactantEquation[69]>", line 7, in ?
        levEq.solve(levVar, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/models/levelSet/surfactant/adsorbingSurfactantEquation.py", line 369, in solve
        SurfactantEquation.solve(self, var, boundaryConditions = boundaryConditions, solver = solver, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/models/levelSet/surfactant/surfactantEquation.py", line 96, in solve
        solver = solver)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 66, in _buildMatrix
        termMatrix, termRHSvector = self.term2._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/faceTerm.py", line 173, in _buildMatrix
        self._explicitBuildMatrix(var.getOld(), id1, id2, b, weight['explicit'], mesh, boundaryConditions, interiorFaces, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/faceTerm.py", line 100, in _explicitBuildMatrix
        b -= LL * numerix.array(oldArray)
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 227, in __mul__
        self.matrix.matvec(other, y)
    TypeError: argument 1 must be array, not numpy.ndarray


======================================================================
FAIL: Doctest: fipy.terms.diffusionTerm.DiffusionTerm._test
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for fipy.terms.diffusionTerm.DiffusionTerm._test
  File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 284, in _test

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 384, in fipy.terms.diffusionTerm.DiffusionTerm._test
Failed example:
    L,b = term._buildMatrix(var = CellVariable(mesh = mesh), 
                            boundaryConditions = (bcLeft1, bcLeft2, 
                                                  bcRight1, bcRight2))
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest fipy.terms.diffusionTerm.DiffusionTerm._test[52]>", line 2, in ?
        boundaryConditions = (bcLeft1, bcLeft2,
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 241, in _buildMatrix
        b = L * lowerOrderb + b
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 227, in __mul__
        self.matrix.matvec(other, y)
    TypeError: argument 1 must be array, not numpy.ndarray
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 387, in fipy.terms.diffusionTerm.DiffusionTerm._test
Failed example:
    print L
Expected:
     4.000000  -6.000000  
    -4.000000  10.000000  
Got:
    -1.000000   1.000000  
     1.000000  -3.000000  
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 390, in fipy.terms.diffusionTerm.DiffusionTerm._test
Failed example:
    print b
Expected:
    [  1.  21.]
Got:
    [-3. -8.]
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 405, in fipy.terms.diffusionTerm.DiffusionTerm._test
Failed example:
    L,b = term._buildMatrix(var = CellVariable(mesh = mesh),
                            boundaryConditions = (bcLeft1, bcLeft2, 
                                                  bcRight1, bcRight2))
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest fipy.terms.diffusionTerm.DiffusionTerm._test[62]>", line 2, in ?
        boundaryConditions = (bcLeft1, bcLeft2,
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 241, in _buildMatrix
        b = L * lowerOrderb + b
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 227, in __mul__
        self.matrix.matvec(other, y)
    TypeError: argument 1 must be array, not numpy.ndarray
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 408, in fipy.terms.diffusionTerm.DiffusionTerm._test
Failed example:
    print L
Expected:
    -4.000000   6.000000  
     2.000000  -4.000000  
Got:
    -1.000000   1.000000  
     1.000000  -3.000000  
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 411, in fipy.terms.diffusionTerm.DiffusionTerm._test
Failed example:
    print b
Expected:
    [ 3. -4.]
Got:
    [-3. -8.]
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 426, in fipy.terms.diffusionTerm.DiffusionTerm._test
Failed example:
    L,b = term._buildMatrix(var = CellVariable(mesh = mesh), 
                            boundaryConditions = (bcLeft1, bcLeft2, 
                                                  bcRight1, bcRight2))
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest fipy.terms.diffusionTerm.DiffusionTerm._test[73]>", line 2, in ?
        boundaryConditions = (bcLeft1, bcLeft2,
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 241, in _buildMatrix
        b = L * lowerOrderb + b
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 227, in __mul__
        self.matrix.matvec(other, y)
    TypeError: argument 1 must be array, not numpy.ndarray
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 430, in fipy.terms.diffusionTerm.DiffusionTerm._test
Failed example:
    print numerix.allclose(L.getNumpyArray(), ans)
Expected:
    1
Got:
    False
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 432, in fipy.terms.diffusionTerm.DiffusionTerm._test
Failed example:
    print b
Expected:
    [-8.  4.]
Got:
    [-3. -8.]
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 447, in fipy.terms.diffusionTerm.DiffusionTerm._test
Failed example:
    L,b = term._buildMatrix(var = CellVariable(mesh = mesh), 
                            boundaryConditions = (bcLeft1, bcLeft2, 
                                                  bcRight1, bcRight2))
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest fipy.terms.diffusionTerm.DiffusionTerm._test[85]>", line 2, in ?
        boundaryConditions = (bcLeft1, bcLeft2,
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 241, in _buildMatrix
        b = L * lowerOrderb + b
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 227, in __mul__
        self.matrix.matvec(other, y)
    TypeError: argument 1 must be array, not numpy.ndarray
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 451, in fipy.terms.diffusionTerm.DiffusionTerm._test
Failed example:
    print numerix.allclose(L.getNumpyArray(), ans)
Expected:
    1
Got:
    False
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 453, in fipy.terms.diffusionTerm.DiffusionTerm._test
Failed example:
    print b
Expected:
    [-24.  16.]
Got:
    [-3. -8.]


======================================================================
FAIL: Doctest: fipy.tools.sparseMatrix._SparseMatrix.__mul__
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for fipy.tools.sparseMatrix._SparseMatrix.__mul__
  File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 185, in __mul__

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 204, in fipy.tools.sparseMatrix._SparseMatrix.__mul__
Failed example:
    numerix.allclose(L1 * numerix.array((1,2,3),'d'), tmp)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest fipy.tools.sparseMatrix._SparseMatrix.__mul__[7]>", line 1, in ?
        numerix.allclose(L1 * numerix.array((1,2,3),'d'), tmp)
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 227, in __mul__
        self.matrix.matvec(other, y)
    TypeError: argument 1 must be array, not numpy.ndarray
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 210, in fipy.tools.sparseMatrix._SparseMatrix.__mul__
Failed example:
    numerix.allclose(numerix.array((1,2,3),'d') * L1, tmp) ## The multiplication is broken. Numpy is calling __rmul__ for every element instead of with  the whole array.
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest fipy.tools.sparseMatrix._SparseMatrix.__mul__[9]>", line 1, in ?
        numerix.allclose(numerix.array((1,2,3),'d') * L1, tmp) ## The multiplication is broken. Numpy is calling __rmul__ for every element instead of with  the whole array.
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 235, in __rmul__
        self.matrix.matvec_transp(other, y)
    TypeError: argument 1 must be array, not numpy.ndarray


======================================================================
FAIL: Doctest: fipy.meshes.numMesh.gmshImport
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for fipy.meshes.numMesh.gmshImport
  File "/home/username/tmp/fipy-current/fipy/meshes/numMesh/gmshImport.py", line 7, in gmshImport

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/fipy/meshes/numMesh/gmshImport.py", line 180, in fipy.meshes.numMesh.gmshImport
Failed example:
    mesh = buildMesh(lines)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest fipy.meshes.numMesh.gmshImport[14]>", line 1, in ?
        mesh = buildMesh(lines)
      File "<doctest fipy.meshes.numMesh.gmshImport[13]>", line 18, in buildMesh
        mesh = GmshImporter2D(meshName)
      File "/home/username/tmp/fipy-current/fipy/meshes/numMesh/gmshImport.py", line 394, in __init__
        mesh2D.Mesh2D.__init__(self, **_DataGetter().getData(filename, dimensions = 2, coordDimensions = coordDimensions))
      File "/home/username/tmp/fipy-current/fipy/meshes/numMesh/gmshImport.py", line 263, in getData
        vertexCoords = self._calcVertexCoords(coordDimensions)
      File "/home/username/tmp/fipy-current/fipy/meshes/numMesh/gmshImport.py", line 286, in _calcVertexCoords
        numVertices = int(self.inFile.readline())
    ValueError: invalid literal for int(): 
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/fipy/meshes/numMesh/gmshImport.py", line 192, in fipy.meshes.numMesh.gmshImport
Failed example:
    mesh = buildMesh(lines)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest fipy.meshes.numMesh.gmshImport[17]>", line 1, in ?
        mesh = buildMesh(lines)
      File "<doctest fipy.meshes.numMesh.gmshImport[13]>", line 18, in buildMesh
        mesh = GmshImporter2D(meshName)
      File "/home/username/tmp/fipy-current/fipy/meshes/numMesh/gmshImport.py", line 394, in __init__
        mesh2D.Mesh2D.__init__(self, **_DataGetter().getData(filename, dimensions = 2, coordDimensions = coordDimensions))
      File "/home/username/tmp/fipy-current/fipy/meshes/numMesh/gmshImport.py", line 263, in getData
        vertexCoords = self._calcVertexCoords(coordDimensions)
      File "/home/username/tmp/fipy-current/fipy/meshes/numMesh/gmshImport.py", line 286, in _calcVertexCoords
        numVertices = int(self.inFile.readline())
    ValueError: invalid literal for int(): 


======================================================================
FAIL: Doctest: fipy.variables.variable.Variable.__array__
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for fipy.variables.variable.Variable.__array__
  File "/home/username/tmp/fipy-current/fipy/variables/variable.py", line 179, in __array__

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/fipy/variables/variable.py", line 198, in fipy.variables.variable.Variable.__array__
Failed example:
    numerix.array([Variable(0), Variable(0)])
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest fipy.variables.variable.Variable.__array__[4]>", line 1, in ?
        numerix.array([Variable(0), Variable(0)])
    ValueError: setting an array element with a sequence.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/fipy/variables/variable.py", line 203, in fipy.variables.variable.Variable.__array__
Failed example:
    numerix.array([Variable(0) + Variable(0), Variable(0)])
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest fipy.variables.variable.Variable.__array__[6]>", line 1, in ?
        numerix.array([Variable(0) + Variable(0), Variable(0)])
    ValueError: setting an array element with a sequence.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/fipy/variables/variable.py", line 205, in fipy.variables.variable.Variable.__array__
Failed example:
    numerix.array([Variable(0), Variable(0) + Variable(0)])
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest fipy.variables.variable.Variable.__array__[7]>", line 1, in ?
        numerix.array([Variable(0), Variable(0) + Variable(0)])
    ValueError: setting an array element with a sequence.


======================================================================
FAIL: Doctest: examples.convection.exponential1D.input
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for examples.convection.exponential1D.input
  File "/home/username/tmp/fipy-current/examples/convection/exponential1D/input.py", line 6, in input

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/convection/exponential1D/input.py", line 107, in examples.convection.exponential1D.input
Failed example:
    eq.solve(var=var, boundaryConditions=boundaryConditions)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.convection.exponential1D.input[16]>", line 1, in ?
        eq.solve(var=var, boundaryConditions=boundaryConditions)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/convection/exponential1D/input.py", line 126, in examples.convection.exponential1D.input
Failed example:
    print var.allclose(analyticalArray)
Expected:
    1
Got:
    False


======================================================================
FAIL: Doctest: examples.convection.exponential1D.tri2Dinput
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for examples.convection.exponential1D.tri2Dinput
  File "/home/username/tmp/fipy-current/examples/convection/exponential1D/tri2Dinput.py", line 6, in tri2Dinput

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/convection/exponential1D/tri2Dinput.py", line 51, in examples.convection.exponential1D.tri2Dinput
Failed example:
    eq.solve(var = var,
             boundaryConditions = boundaryConditions,
             solver = LinearCGSSolver(tolerance=1.e-15, iterations=2000))
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.convection.exponential1D.tri2Dinput[18]>", line 3, in ?
        solver = LinearCGSSolver(tolerance=1.e-15, iterations=2000))
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/convection/exponential1D/tri2Dinput.py", line 63, in examples.convection.exponential1D.tri2Dinput
Failed example:
    print var.allclose(analyticalArray, rtol = 1e-6, atol = 1e-6) 
Expected:
    1
Got:
    False


======================================================================
FAIL: Doctest: examples.convection.exponential2D.input
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for examples.convection.exponential2D.input
  File "/home/username/tmp/fipy-current/examples/convection/exponential2D/input.py", line 6, in input

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/convection/exponential2D/input.py", line 43, in examples.convection.exponential2D.input
Failed example:
    eq.solve(var = var,
             boundaryConditions = boundaryConditions,
             solver = LinearCGSSolver(tolerance = 1.e-15, iterations = 2000))
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.convection.exponential2D.input[18]>", line 3, in ?
        solver = LinearCGSSolver(tolerance = 1.e-15, iterations = 2000))
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/convection/exponential2D/input.py", line 55, in examples.convection.exponential2D.input
Failed example:
    print var.allclose(analyticalArray, rtol = 1e-10, atol = 1e-10) 
Expected:
    1
Got:
    False


======================================================================
FAIL: Doctest: examples.convection.exponential1DBack.input
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for examples.convection.exponential1DBack.input
  File "/home/username/tmp/fipy-current/examples/convection/exponential1DBack/input.py", line 6, in input

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/convection/exponential1DBack/input.py", line 47, in examples.convection.exponential1DBack.input
Failed example:
    eq.solve(var = var,
             boundaryConditions = boundaryConditions,
             solver = LinearCGSSolver(tolerance = 1.e-15, iterations = 2000))
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.convection.exponential1DBack.input[17]>", line 3, in ?
        solver = LinearCGSSolver(tolerance = 1.e-15, iterations = 2000))
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/convection/exponential1DBack/input.py", line 59, in examples.convection.exponential1DBack.input
Failed example:
    print var.allclose(analyticalArray, rtol = 1e-10, atol = 1e-10) 
Expected:
    1
Got:
    False


======================================================================
FAIL: Doctest: examples.convection.powerLaw1D.input
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for examples.convection.powerLaw1D.input
  File "/home/username/tmp/fipy-current/examples/convection/powerLaw1D/input.py", line 6, in input

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/convection/powerLaw1D/input.py", line 42, in examples.convection.powerLaw1D.input
Failed example:
    eq.solve(var = var,
             boundaryConditions = boundaryConditions)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.convection.powerLaw1D.input[16]>", line 2, in ?
        boundaryConditions = boundaryConditions)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/convection/powerLaw1D/input.py", line 54, in examples.convection.powerLaw1D.input
Failed example:
    print var.allclose(analyticalArray, rtol = 1e-2, atol = 1e-2) 
Expected:
    1
Got:
    False


======================================================================
FAIL: Doctest: examples.convection.exponential1DSource.input
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for examples.convection.exponential1DSource.input
  File "/home/username/tmp/fipy-current/examples/convection/exponential1DSource/input.py", line 6, in input

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/convection/exponential1DSource/input.py", line 95, in examples.convection.exponential1DSource.input
Failed example:
    eq.solve(var = var, 
             boundaryConditions = boundaryConditions,
             solver = LinearLUSolver(tolerance = 1.e-15))
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.convection.exponential1DSource.input[18]>", line 3, in ?
        solver = LinearLUSolver(tolerance = 1.e-15))
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/convection/exponential1DSource/input.py", line 119, in examples.convection.exponential1DSource.input
Failed example:
    print var.allclose(analyticalArray, rtol=1e-4, atol=1e-4)
Expected:
    1
Got:
    False


======================================================================
FAIL: Doctest: examples.convection.exponential2D.tri2Dinput
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for examples.convection.exponential2D.tri2Dinput
  File "/home/username/tmp/fipy-current/examples/convection/exponential2D/tri2Dinput.py", line 6, in tri2Dinput

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/convection/exponential2D/tri2Dinput.py", line 42, in examples.convection.exponential2D.tri2Dinput
Failed example:
    eq.solve(var = var,
             boundaryConditions = boundaryConditions,
             solver = LinearCGSSolver(tolerance = 1.e-15, iterations = 2000))
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.convection.exponential2D.tri2Dinput[18]>", line 3, in ?
        solver = LinearCGSSolver(tolerance = 1.e-15, iterations = 2000))
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/convection/exponential2D/tri2Dinput.py", line 54, in examples.convection.exponential2D.tri2Dinput
Failed example:
    print var.allclose(analyticalArray, rtol = 1e-10, atol = 1e-10) 
Expected:
    1
Got:
    False


======================================================================
FAIL: Doctest: examples.convection.exponential1DSource.tri2Dinput
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for examples.convection.exponential1DSource.tri2Dinput
  File "/home/username/tmp/fipy-current/examples/convection/exponential1DSource/tri2Dinput.py", line 6, in tri2Dinput

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/convection/exponential1DSource/tri2Dinput.py", line 57, in examples.convection.exponential1DSource.tri2Dinput
Failed example:
    eq.solve(var = var,
             boundaryConditions = boundaryConditions,
             solver = LinearLUSolver(tolerance = 1.e-15, iterations = 2000))
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.convection.exponential1DSource.tri2Dinput[19]>", line 3, in ?
        solver = LinearLUSolver(tolerance = 1.e-15, iterations = 2000))
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 66, in _buildMatrix
        termMatrix, termRHSvector = self.term2._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/convection/exponential1DSource/tri2Dinput.py", line 71, in examples.convection.exponential1DSource.tri2Dinput
Failed example:
    print var.allclose(analyticalArray, atol = 1e-5) 
Expected:
    1
Got:
    False


======================================================================
FAIL: Doctest: examples.convection.powerLaw1D.tri2Dinput
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for examples.convection.powerLaw1D.tri2Dinput
  File "/home/username/tmp/fipy-current/examples/convection/powerLaw1D/tri2Dinput.py", line 6, in tri2Dinput

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/convection/powerLaw1D/tri2Dinput.py", line 42, in examples.convection.powerLaw1D.tri2Dinput
Failed example:
    eq.solve(var = var,
             boundaryConditions = boundaryConditions,
             solver = LinearCGSSolver(tolerance = 1.e-15, iterations = 2000))
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.convection.powerLaw1D.tri2Dinput[17]>", line 3, in ?
        solver = LinearCGSSolver(tolerance = 1.e-15, iterations = 2000))
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/convection/powerLaw1D/tri2Dinput.py", line 54, in examples.convection.powerLaw1D.tri2Dinput
Failed example:
    print var.allclose(analyticalArray, rtol = 1e-2, atol = 1e-2) 
Expected:
    1
Got:
    False


======================================================================
FAIL: Doctest: examples.convection.advection.inputVanLeerUpwind
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for examples.convection.advection.inputVanLeerUpwind
  File "/home/username/tmp/fipy-current/examples/convection/advection/inputVanLeerUpwind.py", line 6, in inputVanLeerUpwind

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/convection/advection/inputVanLeerUpwind.py", line 25, in examples.convection.advection.inputVanLeerUpwind
Failed example:
    for step in range(steps):
        eq1.solve(var = var1, dt = dt, solver = LinearLUSolver())
        eq2.solve(var = var2, dt = dt, solver = LinearLUSolver())
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.convection.advection.inputVanLeerUpwind[2]>", line 2, in ?
        eq1.solve(var = var1, dt = dt, solver = LinearLUSolver())
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 123, in solve
        self._solveLinearSystem(var, solver, matrix, RHSvector)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 102, in _solveLinearSystem
        solver._solve(matrix, array, RHSvector)
      File "/home/username/tmp/fipy-current/fipy/solvers/linearLUSolver.py", line 98, in _solve
        errorVector = L * x - b
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 227, in __mul__
        self.matrix.matvec(other, y)
    TypeError: argument 1 must be array, not numpy.ndarray
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/convection/advection/inputVanLeerUpwind.py", line 32, in examples.convection.advection.inputVanLeerUpwind
Failed example:
    print newVar2.allclose(var1[nx / 4:3 * nx / 4], atol = 1e-6)
Expected:
    1
Got:
    False


======================================================================
FAIL: Doctest: examples.convection.peclet
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for examples.convection.peclet
  File "/home/username/tmp/fipy-current/examples/convection/peclet.py", line 6, in peclet

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/convection/peclet.py", line 46, in examples.convection.peclet
Failed example:
    while peclet < 1e4:
        var[:] = valueLeft
        diffCoeff = convCoeff * dx / peclet
        diffTerm = ImplicitDiffusionTerm(coeff=diffCoeff)
        eq = TransientTerm(1e-4) == diffTerm + PowerLawConvectionTerm(coeff=convCoeff, diffusionTerm=diffTerm)
        eq.solve(var=var, boundaryConditions=boundaryConditions) ##, solver=GMRES())
        x = mesh.getCellCenters()[...,0]
        arg0 = -convCoeff * x / diffCoeff
        arg0 = numerix.where(arg0 < -200, -200, arg0)
        arg1 = -convCoeff * L / diffCoeff
        arg1 = (arg1 >= -200) * (arg1 + 200) - 200  
        CC = 1. - numerix.exp(arg0)
        DD = 1. - numerix.exp(arg1)
        analyticalArray = CC / DD
        allcloseList.append(var.allclose(CC / DD, rtol = 1e-2, atol = 1e-2).getValue())
        if __name__ == '__main__':
            viewer.plot()
            raw_input("Peclet number: " + str(peclet) + ", press key")
        peclet *= 10
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.convection.peclet[19]>", line 6, in ?
        eq.solve(var=var, boundaryConditions=boundaryConditions) ##, solver=GMRES())
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 66, in _buildMatrix
        termMatrix, termRHSvector = self.term2._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/convection/peclet.py", line 66, in examples.convection.peclet
Failed example:
    print allcloseList
Expected:
    [True, True, True, True, True, True, True]
Got:
    []


======================================================================
FAIL: Doctest: examples.diffusion.steadyState.mesh1D.tri2Dinput
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for examples.diffusion.steadyState.mesh1D.tri2Dinput
  File "/home/username/tmp/fipy-current/examples/diffusion/steadyState/mesh1D/tri2Dinput.py", line 6, in tri2Dinput

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/steadyState/mesh1D/tri2Dinput.py", line 25, in examples.diffusion.steadyState.mesh1D.tri2Dinput
Failed example:
    ImplicitDiffusionTerm().solve(var, boundaryConditions = boundaryConditions)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.diffusion.steadyState.mesh1D.tri2Dinput[0]>", line 1, in ?
        ImplicitDiffusionTerm().solve(var, boundaryConditions = boundaryConditions)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/steadyState/mesh1D/tri2Dinput.py", line 39, in examples.diffusion.steadyState.mesh1D.tri2Dinput
Failed example:
    print var.allclose(analyticalArray)
Expected:
    1
Got:
    False


======================================================================
FAIL: Doctest: examples.diffusion.steadyState.mesh1D.inputPeriodic
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for examples.diffusion.steadyState.mesh1D.inputPeriodic
  File "/home/username/tmp/fipy-current/examples/diffusion/steadyState/mesh1D/inputPeriodic.py", line 6, in inputPeriodic

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/steadyState/mesh1D/inputPeriodic.py", line 44, in examples.diffusion.steadyState.mesh1D.inputPeriodic
Failed example:
    eq.solve(var = var)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.diffusion.steadyState.mesh1D.inputPeriodic[15]>", line 1, in ?
        eq.solve(var = var)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 66, in _buildMatrix
        termMatrix, termRHSvector = self.term2._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/steadyState/mesh1D/inputPeriodic.py", line 51, in examples.diffusion.steadyState.mesh1D.inputPeriodic
Failed example:
    var.allclose((valueLeft + valueRight) / 2., rtol = 1e-5).getValue()
Expected:
    1
Got:
    False


======================================================================
FAIL: Doctest: examples.diffusion.steadyState.mesh20x20.tri2Dinput
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for examples.diffusion.steadyState.mesh20x20.tri2Dinput
  File "/home/username/tmp/fipy-current/examples/diffusion/steadyState/mesh20x20/tri2Dinput.py", line 6, in tri2Dinput

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/steadyState/mesh20x20/tri2Dinput.py", line 11, in examples.diffusion.steadyState.mesh20x20.tri2Dinput
Failed example:
    ImplicitDiffusionTerm().solve(var, boundaryConditions = boundaryConditions)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.diffusion.steadyState.mesh20x20.tri2Dinput[0]>", line 1, in ?
        ImplicitDiffusionTerm().solve(var, boundaryConditions = boundaryConditions)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/steadyState/mesh20x20/tri2Dinput.py", line 18, in examples.diffusion.steadyState.mesh20x20.tri2Dinput
Failed example:
    print var.allclose(analyticalArray, rtol = 1e-8)
Expected:
    1
Got:
    False


======================================================================
FAIL: Doctest: examples.diffusion.steadyState.mesh50x50.input
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for examples.diffusion.steadyState.mesh50x50.input
  File "/home/username/tmp/fipy-current/examples/diffusion/steadyState/mesh50x50/input.py", line 6, in input

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/steadyState/mesh50x50/input.py", line 17, in examples.diffusion.steadyState.mesh50x50.input
Failed example:
    ImplicitDiffusionTerm().solve(var, boundaryConditions = boundaryConditions)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.diffusion.steadyState.mesh50x50.input[0]>", line 1, in ?
        ImplicitDiffusionTerm().solve(var, boundaryConditions = boundaryConditions)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/steadyState/mesh50x50/input.py", line 21, in examples.diffusion.steadyState.mesh50x50.input
Failed example:
    print var.allclose(analyticalArray, rtol = 1e-9)
Expected:
    1
Got:
    False


======================================================================
FAIL: Doctest: examples.diffusion.steadyState.mesh50x50.tri2Dinput
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for examples.diffusion.steadyState.mesh50x50.tri2Dinput
  File "/home/username/tmp/fipy-current/examples/diffusion/steadyState/mesh50x50/tri2Dinput.py", line 6, in tri2Dinput

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/steadyState/mesh50x50/tri2Dinput.py", line 18, in examples.diffusion.steadyState.mesh50x50.tri2Dinput
Failed example:
    ImplicitDiffusionTerm().solve(var, boundaryConditions = boundaryConditions)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.diffusion.steadyState.mesh50x50.tri2Dinput[2]>", line 1, in ?
        ImplicitDiffusionTerm().solve(var, boundaryConditions = boundaryConditions)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/steadyState/mesh50x50/tri2Dinput.py", line 22, in examples.diffusion.steadyState.mesh50x50.tri2Dinput
Failed example:
    print var.allclose(analyticalArray, atol = 1e-8)
Expected:
    1
Got:
    False


======================================================================
FAIL: Doctest: examples.diffusion.steadyState.otherMeshes.grid3Dinput
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for examples.diffusion.steadyState.otherMeshes.grid3Dinput
  File "/home/username/tmp/fipy-current/examples/diffusion/steadyState/otherMeshes/grid3Dinput.py", line 6, in grid3Dinput

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/steadyState/otherMeshes/grid3Dinput.py", line 10, in examples.diffusion.steadyState.otherMeshes.grid3Dinput
Failed example:
    ImplicitDiffusionTerm().solve(var, boundaryConditions = boundaryConditions)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.diffusion.steadyState.otherMeshes.grid3Dinput[0]>", line 1, in ?
        ImplicitDiffusionTerm().solve(var, boundaryConditions = boundaryConditions)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/steadyState/otherMeshes/grid3Dinput.py", line 11, in examples.diffusion.steadyState.otherMeshes.grid3Dinput
Failed example:
    ImplicitDiffusionTerm().solve(var2, boundaryConditions = boundaryConditions2)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.diffusion.steadyState.otherMeshes.grid3Dinput[1]>", line 1, in ?
        ImplicitDiffusionTerm().solve(var2, boundaryConditions = boundaryConditions2)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.


======================================================================
FAIL: Doctest: examples.diffusion.steadyState.mesh20x20.modifiedMeshInput
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for examples.diffusion.steadyState.mesh20x20.modifiedMeshInput
  File "/home/username/tmp/fipy-current/examples/diffusion/steadyState/mesh20x20/modifiedMeshInput.py", line 6, in modifiedMeshInput

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/steadyState/mesh20x20/modifiedMeshInput.py", line 15, in examples.diffusion.steadyState.mesh20x20.modifiedMeshInput
Failed example:
    ImplicitDiffusionTerm().solve(var, boundaryConditions = boundaryConditions)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.diffusion.steadyState.mesh20x20.modifiedMeshInput[0]>", line 1, in ?
        ImplicitDiffusionTerm().solve(var, boundaryConditions = boundaryConditions)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/steadyState/mesh20x20/modifiedMeshInput.py", line 19, in examples.diffusion.steadyState.mesh20x20.modifiedMeshInput
Failed example:
    print var.allclose(analyticalArray, atol = 0.025)
Expected:
    1
Got:
    False


======================================================================
FAIL: Doctest: examples.diffusion.explicit.mesh10.tri2Dinput
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for examples.diffusion.explicit.mesh10.tri2Dinput
  File "/home/username/tmp/fipy-current/examples/diffusion/explicit/mesh10/tri2Dinput.py", line 6, in tri2Dinput

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/explicit/mesh10/tri2Dinput.py", line 28, in examples.diffusion.explicit.mesh10.tri2Dinput
Failed example:
    for step in range(steps):
        eq.solve(var, solver = solver, boundaryConditions = boundaryConditions, dt = timeStepDuration)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.diffusion.explicit.mesh10.tri2Dinput[8]>", line 2, in ?
        eq.solve(var, solver = solver, boundaryConditions = boundaryConditions, dt = timeStepDuration)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 66, in _buildMatrix
        termMatrix, termRHSvector = self.term2._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/explicitDiffusionTerm.py", line 62, in _buildMatrix
        L, b = DiffusionTerm._buildMatrix(self, var.getOld(), boundaryConditions = boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/explicit/mesh10/tri2Dinput.py", line 37, in examples.diffusion.explicit.mesh10.tri2Dinput
Failed example:
    print var.allclose(answer, rtol = 1e-8)
Expected:
    1
Got:
    False


======================================================================
FAIL: Doctest: examples.diffusion.explicit.mesh10.input
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for examples.diffusion.explicit.mesh10.input
  File "/home/username/tmp/fipy-current/examples/diffusion/explicit/mesh10/input.py", line 6, in input

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/explicit/mesh10/input.py", line 64, in examples.diffusion.explicit.mesh10.input
Failed example:
    for step in range(steps):
        var.updateOld()     
        eq.solve(var = var, boundaryConditions = boundaryConditions,
                            dt = timeStepDuration)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.diffusion.explicit.mesh10.input[16]>", line 4, in ?
        dt = timeStepDuration)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 66, in _buildMatrix
        termMatrix, termRHSvector = self.term2._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/explicitDiffusionTerm.py", line 62, in _buildMatrix
        L, b = DiffusionTerm._buildMatrix(self, var.getOld(), boundaryConditions = boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/explicit/mesh10/input.py", line 85, in examples.diffusion.explicit.mesh10.input
Failed example:
    print var.allclose(analyticalArray, atol = 2e-3)
Expected:
    1
Got:
    False


======================================================================
FAIL: Doctest: examples.diffusion.explicit.mesh10.mixedelement
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for examples.diffusion.explicit.mesh10.mixedelement
  File "/home/username/tmp/fipy-current/examples/diffusion/explicit/mesh10/mixedelement.py", line 6, in mixedelement

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/explicit/mesh10/mixedelement.py", line 28, in examples.diffusion.explicit.mesh10.mixedelement
Failed example:
    for step in range(steps):
        var.updateOld()
        eqn.solve(var, boundaryConditions = boundaryConditions, dt = timeStepDuration)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.diffusion.explicit.mesh10.mixedelement[8]>", line 3, in ?
        eqn.solve(var, boundaryConditions = boundaryConditions, dt = timeStepDuration)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 66, in _buildMatrix
        termMatrix, termRHSvector = self.term2._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/explicitDiffusionTerm.py", line 62, in _buildMatrix
        L, b = DiffusionTerm._buildMatrix(self, var.getOld(), boundaryConditions = boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 170, in _getCoefficientMatrix
        coefficientMatrix.addAtDiagonal(numerix.sum(interiorCoeff, 1))
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 332, in addAtDiagonal
        self.addAt(vector, ids, ids)
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/explicit/mesh10/mixedelement.py", line 38, in examples.diffusion.explicit.mesh10.mixedelement
Failed example:
    print var.allclose(answer)
Expected:
    1
Got:
    False


======================================================================
FAIL: Doctest: examples.diffusion.variable.tri2Dinput
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for examples.diffusion.variable.tri2Dinput
  File "/home/username/tmp/fipy-current/examples/diffusion/variable/tri2Dinput.py", line 6, in tri2Dinput

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/variable/tri2Dinput.py", line 14, in examples.diffusion.variable.tri2Dinput
Failed example:
    ImplicitDiffusionTerm(coeff = diffCoeff).solve(var, boundaryConditions = boundaryConditions)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.diffusion.variable.tri2Dinput[0]>", line 1, in ?
        ImplicitDiffusionTerm(coeff = diffCoeff).solve(var, boundaryConditions = boundaryConditions)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/variable/tri2Dinput.py", line 19, in examples.diffusion.variable.tri2Dinput
Failed example:
    print var.allclose(values, atol = 1e-8, rtol = 1e-8)
Expected:
    1
Got:
    False


======================================================================
FAIL: Doctest: examples.diffusion.nthOrder.input4thOrder1D
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for examples.diffusion.nthOrder.input4thOrder1D
  File "/home/username/tmp/fipy-current/examples/diffusion/nthOrder/input4thOrder1D.py", line 6, in input4thOrder1D

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/nthOrder/input4thOrder1D.py", line 101, in examples.diffusion.nthOrder.input4thOrder1D
Failed example:
    eq.solve(var=var,
             boundaryConditions=BCs,
             solver=LinearLUSolver(tolerance=1e-11))
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.diffusion.nthOrder.input4thOrder1D[18]>", line 3, in ?
        solver=LinearLUSolver(tolerance=1e-11))
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 205, in _buildMatrix
        dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/nthOrder/input4thOrder1D.py", line 118, in examples.diffusion.nthOrder.input4thOrder1D
Failed example:
    print var.allclose(analytical, rtol=1e-4)
Expected:
    1
Got:
    False


======================================================================
FAIL: Doctest: examples.diffusion.nthOrder.input4thOrder-line
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for examples.diffusion.nthOrder.input4thOrder-line
  File "/home/username/tmp/fipy-current/examples/diffusion/nthOrder/input4thOrder-line.py", line 6, in input4thOrder-line

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/nthOrder/input4thOrder-line.py", line 8, in examples.diffusion.nthOrder.input4thOrder-line
Failed example:
    eq.solve(var,
             boundaryConditions = BCs,
             solver = solver)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.diffusion.nthOrder.input4thOrder-line[0]>", line 3, in ?
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 205, in _buildMatrix
        dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.


======================================================================
FAIL: Doctest: examples.diffusion.mesh1D
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for examples.diffusion.mesh1D
  File "/home/username/tmp/fipy-current/examples/diffusion/mesh1D.py", line 6, in mesh1D

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/mesh1D.py", line 196, in examples.diffusion.mesh1D
Failed example:
    for step in range(steps):
        eqX.solve(var=phi,
                  boundaryConditions=BCs,
                  dt=timeStepDuration)
        if __name__ == '__main__':
            viewer.plot()
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.diffusion.mesh1D[22]>", line 4, in ?
        dt=timeStepDuration)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 66, in _buildMatrix
        termMatrix, termRHSvector = self.term2._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/explicitDiffusionTerm.py", line 62, in _buildMatrix
        L, b = DiffusionTerm._buildMatrix(self, var.getOld(), boundaryConditions = boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/mesh1D.py", line 203, in examples.diffusion.mesh1D
Failed example:
    print phi.allclose(phiAnalytical, atol = 7e-4)
Expected:
    1
Got:
    False
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/mesh1D.py", line 251, in examples.diffusion.mesh1D
Failed example:
    for step in range(steps):
        eqI.solve(var=phi,
                  boundaryConditions=BCs,
                  dt=timeStepDuration)
        if __name__ == '__main__':
            viewer.plot()
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.diffusion.mesh1D[30]>", line 4, in ?
        dt=timeStepDuration)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 66, in _buildMatrix
        termMatrix, termRHSvector = self.term2._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/mesh1D.py", line 258, in examples.diffusion.mesh1D
Failed example:
    print phi.allclose(phiAnalytical, atol = 2e-2)
Expected:
    1
Got:
    False
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/mesh1D.py", line 296, in examples.diffusion.mesh1D
Failed example:
    for step in range(steps - 1):
        eqCN.solve(var=phi,
                   boundaryConditions=BCs,
                   dt=timeStepDuration)
        if __name__ == '__main__':
            viewer.plot()
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.diffusion.mesh1D[35]>", line 4, in ?
        dt=timeStepDuration)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 66, in _buildMatrix
        termMatrix, termRHSvector = self.term2._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/explicitDiffusionTerm.py", line 62, in _buildMatrix
        L, b = DiffusionTerm._buildMatrix(self, var.getOld(), boundaryConditions = boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/mesh1D.py", line 302, in examples.diffusion.mesh1D
Failed example:
    eqI.solve(var=phi,
              boundaryConditions=BCs,
              dt=timeStepDuration)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.diffusion.mesh1D[36]>", line 3, in ?
        dt=timeStepDuration)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 66, in _buildMatrix
        termMatrix, termRHSvector = self.term2._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/mesh1D.py", line 308, in examples.diffusion.mesh1D
Failed example:
    print phi.allclose(phiAnalytical, atol = 3e-3)
Expected:
    1
Got:
    False
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/mesh1D.py", line 328, in examples.diffusion.mesh1D
Failed example:
    ImplicitDiffusionTerm(coeff=D).solve(var=phi,
                                         boundaryConditions=BCs)
                                         
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.diffusion.mesh1D[40]>", line 2, in ?
        boundaryConditions=BCs)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/mesh1D.py", line 346, in examples.diffusion.mesh1D
Failed example:
    print phi.allclose(valueLeft + (valueRight - valueLeft) * x / L, 
                       rtol = 1e-10, atol = 1e-10)
Expected:
    1
Got:
    False
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/mesh1D.py", line 390, in examples.diffusion.mesh1D
Failed example:
    while time() < 15:
        time.setValue(time() + dt)
        eqI.solve(var=phi, dt=dt, boundaryConditions=BCs)
        if __name__ == '__main__':
            viewer.plot()
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.diffusion.mesh1D[50]>", line 3, in ?
        eqI.solve(var=phi, dt=dt, boundaryConditions=BCs)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 66, in _buildMatrix
        termMatrix, termRHSvector = self.term2._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/mesh1D.py", line 475, in examples.diffusion.mesh1D
Failed example:
    ImplicitDiffusionTerm(coeff = D).solve(var=phi,
                                           boundaryConditions = BCs)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.diffusion.mesh1D[61]>", line 2, in ?
        boundaryConditions = BCs)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/mesh1D.py", line 500, in examples.diffusion.mesh1D
Failed example:
    print phi.allclose(phiAnalytical, atol = 1e-8, rtol = 1e-8)
Expected:
    1
Got:
    False
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/mesh1D.py", line 623, in examples.diffusion.mesh1D
Failed example:
    for sweeps in range(1,5):
        phi[0].setValue(valueRight)
        for step in range(steps):
            # only move forward in time once per time step
            phi[0].updateOld()
            
            # but "sweep" many times per time step
            for sweep in range(sweeps):
                res = eq.sweep(var=phi[0],
                               boundaryConditions=BCs,
                               dt=timeStepDuration)
            if __name__ == '__main__':
                viewer.plot()
                
        # copy the final result into the appropriate display variable
        phi[sweeps].setValue(phi[0])
        if __name__ == '__main__':
            viewer.plot()
            raw_input("Implicit variable diffusity. %d sweep(s). \
    Residual = %f. Press <return> to proceed..." % (sweeps, (abs(res))))
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.diffusion.mesh1D[78]>", line 11, in ?
        dt=timeStepDuration)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 142, in sweep
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 66, in _buildMatrix
        termMatrix, termRHSvector = self.term2._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/mesh1D.py", line 662, in examples.diffusion.mesh1D
Failed example:
    while res > 1e-6:
        res = eq.sweep(var=phi[0],
                       boundaryConditions=BCs,
                       dt=timeStepDuration)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.diffusion.mesh1D[82]>", line 4, in ?
        dt=timeStepDuration)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 142, in sweep
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/mesh1D.py", line 668, in examples.diffusion.mesh1D
Failed example:
    print phi[0].allclose(phiAnalytical, atol = 1e-1)
Expected:
    1
Got:
    False


======================================================================
FAIL: Doctest: examples.diffusion.mesh20x20
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for examples.diffusion.mesh20x20
  File "/home/username/tmp/fipy-current/examples/diffusion/mesh20x20.py", line 6, in mesh20x20

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/mesh20x20.py", line 90, in examples.diffusion.mesh20x20
Failed example:
    for step in range(steps):
        eq.solve(var=phi,
                 boundaryConditions=BCs,
                 dt=timeStepDuration)
        if __name__ == '__main__':
            viewer.plot()
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.diffusion.mesh20x20[19]>", line 4, in ?
        dt=timeStepDuration)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 66, in _buildMatrix
        termMatrix, termRHSvector = self.term2._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/mesh20x20.py", line 126, in examples.diffusion.mesh20x20
Failed example:
    print phi.allclose(phiAnalytical, atol = 4e-2)
Expected:
    1
Got:
    False
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/mesh20x20.py", line 136, in examples.diffusion.mesh20x20
Failed example:
    ImplicitDiffusionTerm().solve(var=phi, 
                                  boundaryConditions = BCs)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.diffusion.mesh20x20[27]>", line 2, in ?
        boundaryConditions = BCs)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/mesh20x20.py", line 150, in examples.diffusion.mesh20x20
Failed example:
    print phi.allclose(analyticalArray, rtol = 2e-10, atol = 2e-10)
Expected:
    1
Got:
    False


======================================================================
FAIL: Doctest: examples.diffusion.circle
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for examples.diffusion.circle
  File "/home/username/tmp/fipy-current/examples/diffusion/circle.py", line 6, in circle

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/circle.py", line 62, in examples.diffusion.circle
Failed example:
    os.system('gmsh ' + geomName + ' -2 -v 0 -format msh -o ' + meshName)
Expected:
    0
Got:
    32512
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/circle.py", line 78, in examples.diffusion.circle
Failed example:
    mesh = GmshImporter2D(meshName)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.diffusion.circle[16]>", line 1, in ?
        mesh = GmshImporter2D(meshName)
      File "/home/username/tmp/fipy-current/fipy/meshes/numMesh/gmshImport.py", line 394, in __init__
        mesh2D.Mesh2D.__init__(self, **_DataGetter().getData(filename, dimensions = 2, coordDimensions = coordDimensions))
      File "/home/username/tmp/fipy-current/fipy/meshes/numMesh/gmshImport.py", line 263, in getData
        vertexCoords = self._calcVertexCoords(coordDimensions)
      File "/home/username/tmp/fipy-current/fipy/meshes/numMesh/gmshImport.py", line 286, in _calcVertexCoords
        numVertices = int(self.inFile.readline())
    ValueError: invalid literal for int(): 
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/circle.py", line 90, in examples.diffusion.circle
Failed example:
    phi = CellVariable(name = "solution variable",
                       mesh = mesh,
                       value = 0)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.diffusion.circle[19]>", line 2, in ?
        mesh = mesh,
    NameError: name 'mesh' is not defined
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/circle.py", line 146, in examples.diffusion.circle
Failed example:
    exteriorXcoords = numerix.take(mesh.getFaceCenters()[...,0],
                                   mesh.getExteriorFaces())
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.diffusion.circle[27]>", line 1, in ?
        exteriorXcoords = numerix.take(mesh.getFaceCenters()[...,0],
    NameError: name 'mesh' is not defined
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/circle.py", line 156, in examples.diffusion.circle
Failed example:
    BCs = (FixedValue(faces=mesh.getExteriorFaces(), value=exteriorXcoords),)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.diffusion.circle[29]>", line 1, in ?
        BCs = (FixedValue(faces=mesh.getExteriorFaces(), value=exteriorXcoords),)
    NameError: name 'mesh' is not defined
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/circle.py", line 162, in examples.diffusion.circle
Failed example:
    for step in range(steps):
        eq.solve(var=phi,
                 boundaryConditions=BCs,
                 dt=timeStepDuration)
        if viewer is not None:
            viewer.plot()
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.diffusion.circle[32]>", line 2, in ?
        eq.solve(var=phi,
    NameError: name 'phi' is not defined
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/circle.py", line 201, in examples.diffusion.circle
Failed example:
    x, y = mesh.getCellCenters()[...,0], mesh.getCellCenters()[...,1]
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.diffusion.circle[33]>", line 1, in ?
        x, y = mesh.getCellCenters()[...,0], mesh.getCellCenters()[...,1]
    NameError: name 'mesh' is not defined
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/circle.py", line 204, in examples.diffusion.circle
Failed example:
    phiAnalytical = CellVariable(name="analytical value",
                                 mesh=mesh)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.diffusion.circle[35]>", line 2, in ?
        mesh=mesh)
    NameError: name 'mesh' is not defined
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/circle.py", line 218, in examples.diffusion.circle
Failed example:
    x0 = radius * cos(arcsin(y))
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.diffusion.circle[37]>", line 1, in ?
        x0 = radius * cos(arcsin(y))
    NameError: name 'y' is not defined
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/circle.py", line 219, in examples.diffusion.circle
Failed example:
    try:
        from scipy.special import erf
        phiAnalytical.setValue(x0 * (erf((x0+x) / (2 * sqrt(D * t))) 
                                     - erf((x0-x) / (2 * sqrt(D * t)))))
    except ImportError:
        print "The SciPy library is not available to test the solution to \
    the transient diffusion equation"
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.diffusion.circle[38]>", line 3, in ?
        phiAnalytical.setValue(x0 * (erf((x0+x) / (2 * sqrt(D * t)))
    NameError: name 'phiAnalytical' is not defined
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/circle.py", line 227, in examples.diffusion.circle
Failed example:
    print phi.allclose(phiAnalytical, atol = 7e-2)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.diffusion.circle[39]>", line 1, in ?
        print phi.allclose(phiAnalytical, atol = 7e-2)
    NameError: name 'phi' is not defined
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/circle.py", line 238, in examples.diffusion.circle
Failed example:
    ImplicitDiffusionTerm(coeff=D).solve(var=phi,
                                         boundaryConditions=BCs)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.diffusion.circle[41]>", line 1, in ?
        ImplicitDiffusionTerm(coeff=D).solve(var=phi,
    NameError: name 'phi' is not defined
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/circle.py", line 243, in examples.diffusion.circle
Failed example:
    print phi.allclose(mesh.getCellCenters()[...,0], atol = 0.02)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.diffusion.circle[42]>", line 1, in ?
        print phi.allclose(mesh.getCellCenters()[...,0], atol = 0.02)
    NameError: name 'phi' is not defined


======================================================================
FAIL: Doctest: examples.diffusion.electrostatics
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for examples.diffusion.electrostatics
  File "/home/username/tmp/fipy-current/examples/diffusion/electrostatics.py", line 6, in electrostatics

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/electrostatics.py", line 101, in examples.diffusion.electrostatics
Failed example:
    potential.equation.solve(var=potential, 
                             boundaryConditions=bcs)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.diffusion.electrostatics[17]>", line 2, in ?
        boundaryConditions=bcs)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/electrostatics.py", line 118, in examples.diffusion.electrostatics
Failed example:
    print potential.allclose(analytical, rtol = 2e-5, atol = 2e-5)
Expected:
    1
Got:
    False
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/electrostatics.py", line 157, in examples.diffusion.electrostatics
Failed example:
    potential.equation.solve(var=potential, 
                             boundaryConditions=bcs)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.diffusion.electrostatics[25]>", line 2, in ?
        boundaryConditions=bcs)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/electrostatics.py", line 175, in examples.diffusion.electrostatics
Failed example:
    print potential.allclose(analytical, rtol = 2e-5, atol = 2e-5)
Expected:
    1
Got:
    False
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/electrostatics.py", line 206, in examples.diffusion.electrostatics
Failed example:
    potential.equation.solve(var=potential, 
                             boundaryConditions=bcs)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.diffusion.electrostatics[32]>", line 2, in ?
        boundaryConditions=bcs)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/diffusion/electrostatics.py", line 224, in examples.diffusion.electrostatics
Failed example:
    print potential.allclose(analytical, rtol = 2e-5, atol = 2e-5)
Expected:
    1
Got:
    False


======================================================================
FAIL: Doctest: examples.phase.simple.input
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for examples.phase.simple.input
  File "/home/username/tmp/fipy-current/examples/phase/simple/input.py", line 6, in input

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/phase/simple/input.py", line 193, in examples.phase.simple.input
Failed example:
    eq.solve(var = phase)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.phase.simple.input[25]>", line 1, in ?
        eq.solve(var = phase)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/phase/simple/input.py", line 239, in examples.phase.simple.input
Failed example:
    for i in range(13):
        eq.solve(var = phase)
        if __name__ == '__main__':
            viewer.plot()
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.phase.simple.input[32]>", line 2, in ?
        eq.solve(var = phase)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 66, in _buildMatrix
        termMatrix, termRHSvector = self.term2._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/phase/simple/input.py", line 252, in examples.phase.simple.input
Failed example:
    print phase.allclose(analyticalArray, rtol = 1e-4, atol = 1e-4)
Expected:
    1
Got:
    False
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/phase/simple/input.py", line 337, in examples.phase.simple.input
Failed example:
    for i in range(8):
        eq.solve(var = phase)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.phase.simple.input[42]>", line 2, in ?
        eq.solve(var = phase)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/phase/simple/input.py", line 342, in examples.phase.simple.input
Failed example:
    print phase.allclose(analyticalArray, rtol = 1e-4, atol = 1e-4)
Expected:
    1
Got:
    False
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/phase/simple/input.py", line 393, in examples.phase.simple.input
Failed example:
    for i in range(5):
        eq.solve(var = phase)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.phase.simple.input[52]>", line 2, in ?
        eq.solve(var = phase)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/phase/simple/input.py", line 398, in examples.phase.simple.input
Failed example:
    print phase.allclose(analyticalArray, rtol = 1e-4, atol = 1e-4)
Expected:
    1
Got:
    False
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/phase/simple/input.py", line 494, in examples.phase.simple.input
Failed example:
    for i in range(10):
        phase.updateOld()
        res = 1e+10
        while res > 1e-5:
            res = eq.sweep(var=phase, dt=timeStep)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.phase.simple.input[82]>", line 5, in ?
        res = eq.sweep(var=phase, dt=timeStep)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 142, in sweep
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 66, in _buildMatrix
        termMatrix, termRHSvector = self.term2._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/phase/simple/input.py", line 522, in examples.phase.simple.input
Failed example:
    while elapsed < 0.1 * L / velocity:
        phase.updateOld()
        res = 1e+10
        while res > 1e-5:
            res = eq.sweep(var=phase, dt=timeStep)
        elapsed += timeStep
        if __name__ == '__main__':
            viewer2.plot()
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.phase.simple.input[88]>", line 5, in ?
        res = eq.sweep(var=phase, dt=timeStep)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 142, in sweep
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 66, in _buildMatrix
        termMatrix, termRHSvector = self.term2._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/phase/simple/input.py", line 567, in examples.phase.simple.input
Failed example:
    print abs(1 - V_fit / velocity) < 3.3e-2
Expected:
    True
Got:
    False
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/phase/simple/input.py", line 569, in examples.phase.simple.input
Failed example:
    print abs(1 - d_fit / delta) < 2e-2
Expected:
    True
Got:
    False


======================================================================
FAIL: Doctest: examples.phase.anisotropy.input
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for examples.phase.anisotropy.input
  File "/home/username/tmp/fipy-current/examples/phase/anisotropy/input.py", line 6, in input

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/phase/anisotropy/input.py", line 227, in examples.phase.anisotropy.input
Failed example:
    for i in range(steps):
        phase.updateOld()
        temperature.updateOld()
        phaseEq.solve(phase, dt=timeStepDuration)
        temperatureEq.solve(temperature, dt=timeStepDuration)
        if i%10 == 0 and __name__ == '__main__':
            phaseViewer.plot()
            temperatureViewer.plot()
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.phase.anisotropy.input[46]>", line 4, in ?
        phaseEq.solve(phase, dt=timeStepDuration)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 66, in _buildMatrix
        termMatrix, termRHSvector = self.term2._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/explicitDiffusionTerm.py", line 62, in _buildMatrix
        L, b = DiffusionTerm._buildMatrix(self, var.getOld(), boundaryConditions = boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/phase/anisotropy/input.py", line 256, in examples.phase.anisotropy.input
Failed example:
    print allclose(phase, numerix.array(testData))
Expected:
    1
Got:
    False


======================================================================
FAIL: Doctest: examples.phase.impingement.mesh40x1.input
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for examples.phase.impingement.mesh40x1.input
  File "/home/username/tmp/fipy-current/examples/phase/impingement/mesh40x1/input.py", line 6, in input

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/phase/impingement/mesh40x1/input.py", line 247, in examples.phase.impingement.mesh40x1.input
Failed example:
    for i in range(steps):
        theta.updateOld()
        phase.updateOld()
        thetaEq.solve(theta, dt = timeStepDuration)
        phaseEq.solve(phase, dt = timeStepDuration)
        if __name__ == '__main__':
            phaseViewer.plot()
            thetaProductViewer.plot()
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.phase.impingement.mesh40x1.input[48]>", line 4, in ?
        thetaEq.solve(theta, dt = timeStepDuration)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 66, in _buildMatrix
        termMatrix, termRHSvector = self.term2._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/phase/impingement/mesh40x1/input.py", line 275, in examples.phase.impingement.mesh40x1.input
Failed example:
    print theta.allclose(numerix.array(testData))
Expected:
    1
Got:
    False


======================================================================
FAIL: Doctest: examples.phase.impingement.mesh20x20.input
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for examples.phase.impingement.mesh20x20.input
  File "/home/username/tmp/fipy-current/examples/phase/impingement/mesh20x20/input.py", line 6, in input

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/phase/impingement/mesh20x20/input.py", line 248, in examples.phase.impingement.mesh20x20.input
Failed example:
    for i in range(steps):
        theta.updateOld()
        phase.updateOld()
        thetaEq.solve(theta, dt=timeStepDuration)
        phaseEq.solve(phase, dt=timeStepDuration)
        if __name__ == '__main__':
            phaseViewer.plot()
            thetaProductViewer.plot()
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.phase.impingement.mesh20x20.input[48]>", line 4, in ?
        thetaEq.solve(theta, dt=timeStepDuration)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 66, in _buildMatrix
        termMatrix, termRHSvector = self.term2._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/phase/impingement/mesh20x20/input.py", line 259, in examples.phase.impingement.mesh20x20.input
Failed example:
    print theta.allclose(testData, rtol=1e-7, atol=1e-7)
Expected:
    1
Got:
    False
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/phase/impingement/mesh20x20/input.py", line 278, in examples.phase.impingement.mesh20x20.input
Failed example:
    for i in range(steps / 2):
        theta.updateOld()
        phase.updateOld()
        thetaEq.solve(theta, dt=timeStepDuration)
        phaseEq.solve(phase, dt=timeStepDuration)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.phase.impingement.mesh20x20.input[54]>", line 4, in ?
        thetaEq.solve(theta, dt=timeStepDuration)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 66, in _buildMatrix
        termMatrix, termRHSvector = self.term2._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/phase/impingement/mesh20x20/input.py", line 311, in examples.phase.impingement.mesh20x20.input
Failed example:
    for i in range(steps / 2):
        newTheta.updateOld()
        newPhase.updateOld()
        newThetaEq.solve(newTheta, dt=timeStepDuration)
        newPhaseEq.solve(newPhase, dt=timeStepDuration)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.phase.impingement.mesh20x20.input[63]>", line 4, in ?
        newThetaEq.solve(newTheta, dt=timeStepDuration)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 66, in _buildMatrix
        termMatrix, termRHSvector = self.term2._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/phase/impingement/mesh20x20/input.py", line 319, in examples.phase.impingement.mesh20x20.input
Failed example:
    print newTheta.allclose(testData, rtol=1e-7)
Expected:
    1
Got:
    False


======================================================================
FAIL: Doctest: examples.phase.missOrientation.mesh1D.input
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for examples.phase.missOrientation.mesh1D.input
  File "/home/username/tmp/fipy-current/examples/phase/missOrientation/mesh1D/input.py", line 6, in input

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/phase/missOrientation/mesh1D/input.py", line 52, in examples.phase.missOrientation.mesh1D.input
Failed example:
    for step in range(steps):
        phaseEq.solve(phase, dt = timeStepDuration)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.phase.missOrientation.mesh1D.input[0]>", line 2, in ?
        phaseEq.solve(phase, dt = timeStepDuration)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 66, in _buildMatrix
        termMatrix, termRHSvector = self.term2._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/explicitDiffusionTerm.py", line 62, in _buildMatrix
        L, b = DiffusionTerm._buildMatrix(self, var.getOld(), boundaryConditions = boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/phase/missOrientation/mesh1D/input.py", line 66, in examples.phase.missOrientation.mesh1D.input
Failed example:
    print numerix.allclose(numerix.array(testData), phase)
Expected:
    1
Got:
    False


======================================================================
FAIL: Doctest: examples.phase.missOrientation.circle.input
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for examples.phase.missOrientation.circle.input
  File "/home/username/tmp/fipy-current/examples/phase/missOrientation/circle/input.py", line 6, in input

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/phase/missOrientation/circle/input.py", line 53, in examples.phase.missOrientation.circle.input
Failed example:
    for step in range(steps):
        phase.updateOld()
        phaseEq.solve(phase, dt = timeStepDuration)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.phase.missOrientation.circle.input[0]>", line 3, in ?
        phaseEq.solve(phase, dt = timeStepDuration)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 66, in _buildMatrix
        termMatrix, termRHSvector = self.term2._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/explicitDiffusionTerm.py", line 62, in _buildMatrix
        L, b = DiffusionTerm._buildMatrix(self, var.getOld(), boundaryConditions = boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/phase/missOrientation/circle/input.py", line 68, in examples.phase.missOrientation.circle.input
Failed example:
    print numerix.allclose(numerix.array(testData), phase)
Expected:
    1
Got:
    False


======================================================================
FAIL: Doctest: examples.phase.missOrientation.modCircle.input
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for examples.phase.missOrientation.modCircle.input
  File "/home/username/tmp/fipy-current/examples/phase/missOrientation/modCircle/input.py", line 6, in input

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/phase/missOrientation/modCircle/input.py", line 52, in examples.phase.missOrientation.modCircle.input
Failed example:
    for step in range(steps):
        phaseEq.solve(phase, dt = timeStepDuration)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.phase.missOrientation.modCircle.input[0]>", line 2, in ?
        phaseEq.solve(phase, dt = timeStepDuration)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 66, in _buildMatrix
        termMatrix, termRHSvector = self.term2._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/explicitDiffusionTerm.py", line 62, in _buildMatrix
        L, b = DiffusionTerm._buildMatrix(self, var.getOld(), boundaryConditions = boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/phase/missOrientation/modCircle/input.py", line 66, in examples.phase.missOrientation.modCircle.input
Failed example:
    print numerix.allclose(numerix.array(testData), phase)
Expected:
    1
Got:
    False


======================================================================
FAIL: Doctest: examples.phase.binary
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for examples.phase.binary
  File "/home/username/tmp/fipy-current/examples/phase/binary.py", line 6, in binary

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/phase/binary.py", line 565, in examples.phase.binary
Failed example:
    while phaseRes > 1e-3 or diffRes > 1e-3:
        phaseRes = phaseEq.sweep(var=phase, dt=dt)
        diffRes = diffusionEq.sweep(var=C, dt=dt, solver=solver)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.phase.binary[78]>", line 2, in ?
        phaseRes = phaseEq.sweep(var=phase, dt=dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 142, in sweep
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 66, in _buildMatrix
        termMatrix, termRHSvector = self.term2._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/phase/binary.py", line 579, in examples.phase.binary
Failed example:
    print Cs.allclose(C[0], atol=2e-4)
Expected:
    1
Got:
    False
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/phase/binary.py", line 581, in examples.phase.binary
Failed example:
    print Cl.allclose(C[nx-1], atol=2e-4)
Expected:
    1
Got:
    False
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/phase/binary.py", line 609, in examples.phase.binary
Failed example:
    for i in range(100):
        phase.updateOld()
        C.updateOld()
        phaseRes = 1e+10
        diffRes = 1e+10
        while phaseRes > 1e-3 or diffRes > 1e-3:
            phaseRes = phaseEq.sweep(var=phase, dt=dt)
            diffRes = diffusionEq.sweep(var=C, dt=dt, solver=solver)
        if __name__ == '__main__':
            viewer.plot()
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.phase.binary[88]>", line 7, in ?
        phaseRes = phaseEq.sweep(var=phase, dt=dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 142, in sweep
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 66, in _buildMatrix
        termMatrix, termRHSvector = self.term2._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.


======================================================================
FAIL: Doctest: examples.phase.quaternary
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for examples.phase.quaternary
  File "/home/username/tmp/fipy-current/examples/phase/quaternary.py", line 6, in quaternary

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/phase/quaternary.py", line 438, in examples.phase.quaternary
Failed example:
    for i in range(5):
        for field in [phase] + substitutionals + interstitials:
            field.updateOld()
        phase.equation.solve(var = phase, dt = dt)
        for field in substitutionals + interstitials:
            field.equation.solve(var = field, 
                                 dt = dt,
                                 solver = solver)
        if __name__ == '__main__':    
            viewer.plot()
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.phase.quaternary[60]>", line 4, in ?
        phase.equation.solve(var = phase, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 66, in _buildMatrix
        termMatrix, termRHSvector = self.term2._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/phase/quaternary.py", line 477, in examples.phase.quaternary
Failed example:
    print equilibrium
Expected:
    1
Got:
    False


======================================================================
FAIL: Doctest: examples.elphf.diffusion.input1D
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for examples.elphf.diffusion.input1D
  File "/home/username/tmp/fipy-current/examples/elphf/diffusion/input1D.py", line 6, in input1D

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/elphf/diffusion/input1D.py", line 134, in examples.elphf.diffusion.input1D
Failed example:
    for i in range(40):
        for Cj in substitutionals:
            Cj.updateOld()
        for Cj in substitutionals:
            Cj.equation.solve(var = Cj, 
                              dt = 10000,
                              solver = solver)
        if __name__ == '__main__':
            viewer.plot()
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.elphf.diffusion.input1D[25]>", line 7, in ?
        solver = solver)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 66, in _buildMatrix
        termMatrix, termRHSvector = self.term2._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/elphf/diffusion/input1D.py", line 147, in examples.elphf.diffusion.input1D
Failed example:
    substitutionals[0].allclose(0.45, rtol = 1e-7, atol = 1e-7).getValue()
Expected:
    1
Got:
    False
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/elphf/diffusion/input1D.py", line 149, in examples.elphf.diffusion.input1D
Failed example:
    substitutionals[1].allclose(0.45, rtol = 1e-7, atol = 1e-7).getValue()
Expected:
    1
Got:
    False


======================================================================
FAIL: Doctest: examples.elphf.diffusion.input2D
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for examples.elphf.diffusion.input2D
  File "/home/username/tmp/fipy-current/examples/elphf/diffusion/input2D.py", line 6, in input2D

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/elphf/diffusion/input2D.py", line 128, in examples.elphf.diffusion.input2D
Failed example:
    for i in range(40):
        for Cj in substitutionals:
            Cj.updateOld()
        for Cj in substitutionals:
            Cj.equation.solve(var = Cj, 
                              dt = 10000,
                              solver = solver)
        if __name__ == '__main__':
            for viewer in viewers:
                viewer.plot()
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.elphf.diffusion.input2D[29]>", line 7, in ?
        solver = solver)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 66, in _buildMatrix
        termMatrix, termRHSvector = self.term2._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/elphf/diffusion/input2D.py", line 142, in examples.elphf.diffusion.input2D
Failed example:
    substitutionals[0].allclose(0.45, rtol = 1e-7, atol = 1e-7).getValue()
Expected:
    1
Got:
    False
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/elphf/diffusion/input2D.py", line 144, in examples.elphf.diffusion.input2D
Failed example:
    substitutionals[1].allclose(0.45, rtol = 1e-7, atol = 1e-7).getValue()
Expected:
    1
Got:
    False
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/elphf/diffusion/input2D.py", line 158, in examples.elphf.diffusion.input2D
Failed example:
    for i in range(40):
        for Cj in substitutionals:
            Cj.updateOld()
        for Cj in substitutionals:
            Cj.equation.solve(var = Cj, 
                              dt = 10000,
                              solver = solver)
        if __name__ == '__main__':
            for viewer in viewers:
                viewer.plot()
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.elphf.diffusion.input2D[37]>", line 7, in ?
        solver = solver)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 66, in _buildMatrix
        termMatrix, termRHSvector = self.term2._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/elphf/diffusion/input2D.py", line 171, in examples.elphf.diffusion.input2D
Failed example:
    substitutionals[0].allclose(0.375, rtol = 1e-7, atol = 1e-7).getValue()
Expected:
    1
Got:
    False
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/elphf/diffusion/input2D.py", line 173, in examples.elphf.diffusion.input2D
Failed example:
    substitutionals[1].allclose(0.525, rtol = 1e-7, atol = 1e-7).getValue()
Expected:
    1
Got:
    False


======================================================================
FAIL: Doctest: examples.elphf.phase.input1D
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for examples.elphf.phase.input1D
  File "/home/username/tmp/fipy-current/examples/elphf/phase/input1D.py", line 6, in input1D

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/elphf/phase/input1D.py", line 142, in examples.elphf.phase.input1D
Failed example:
    for step in range(10):
        phase.equation.solve(var = phase)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.elphf.phase.input1D[33]>", line 2, in ?
        phase.equation.solve(var = phase)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 66, in _buildMatrix
        termMatrix, termRHSvector = self.term2._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/elphf/phase/input1D.py", line 177, in examples.elphf.phase.input1D
Failed example:
    phase.allclose(analyticalArray, rtol = 1e-4, atol = 1e-4).getValue()
Expected:
    1
Got:
    False


======================================================================
FAIL: Doctest: examples.elphf.phaseDiffusion.input1D
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for examples.elphf.phaseDiffusion.input1D
  File "/home/username/tmp/fipy-current/examples/elphf/phaseDiffusion/input1D.py", line 6, in input1D

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/elphf/phaseDiffusion/input1D.py", line 209, in examples.elphf.phaseDiffusion.input1D
Failed example:
    for i in range(5):
        for field in [phase] + substitutionals + interstitials:
            field.updateOld()
        phase.equation.solve(var = phase, dt = dt)
        for field in substitutionals + interstitials:
            field.equation.solve(var = field, 
                                 dt = dt,
                                 solver = solver)
        if __name__ == '__main__':    
            viewer.plot()
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.elphf.phaseDiffusion.input1D[32]>", line 4, in ?
        phase.equation.solve(var = phase, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 66, in _buildMatrix
        termMatrix, termRHSvector = self.term2._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/elphf/phaseDiffusion/input1D.py", line 234, in examples.elphf.phaseDiffusion.input1D
Failed example:
    print allclose(ends, (0.7, 0.3), rtol = 2e-3, atol = 2e-3)
Expected:
    1
Got:
    False
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/elphf/phaseDiffusion/input1D.py", line 297, in examples.elphf.phaseDiffusion.input1D
Failed example:
    for i in range(5):
        for field in [phase] + substitutionals + interstitials:
            field.updateOld()
        phase.equation.solve(var = phase, dt = dt)
        for field in substitutionals + interstitials:
            field.equation.solve(var = field, 
                                 dt = dt,
                                 solver = solver)
        if __name__ == '__main__':    
            viewer.plot()
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.elphf.phaseDiffusion.input1D[50]>", line 4, in ?
        phase.equation.solve(var = phase, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 66, in _buildMatrix
        termMatrix, termRHSvector = self.term2._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/elphf/phaseDiffusion/input1D.py", line 322, in examples.elphf.phaseDiffusion.input1D
Failed example:
    allclose(ends, (0.4, 0.3), rtol = 3e-3, atol = 3e-3)
Expected:
    1
Got:
    False
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/elphf/phaseDiffusion/input1D.py", line 325, in examples.elphf.phaseDiffusion.input1D
Failed example:
    allclose(ends, (0.3, 0.4), rtol = 3e-3, atol = 3e-3)
Expected:
    1
Got:
    False
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/elphf/phaseDiffusion/input1D.py", line 328, in examples.elphf.phaseDiffusion.input1D
Failed example:
    allclose(ends, (0.1, 0.2), rtol = 3e-3, atol = 3e-3)
Expected:
    1
Got:
    False
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/elphf/phaseDiffusion/input1D.py", line 404, in examples.elphf.phaseDiffusion.input1D
Failed example:
    for i in range(5):
        for field in [phase] + substitutionals + interstitials:
            field.updateOld()
        phase.equation.solve(var = phase, dt = dt)
        for field in substitutionals + interstitials:
            field.equation.solve(var = field, 
                                 dt = dt,
                                 solver = solver)
        if __name__ == '__main__':    
            viewer.plot()
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.elphf.phaseDiffusion.input1D[73]>", line 4, in ?
        phase.equation.solve(var = phase, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 66, in _buildMatrix
        termMatrix, termRHSvector = self.term2._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/elphf/phaseDiffusion/input1D.py", line 429, in examples.elphf.phaseDiffusion.input1D
Failed example:
    allclose(ends, (0.4, 0.3), rtol = 3e-3, atol = 3e-3)
Expected:
    1
Got:
    False
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/elphf/phaseDiffusion/input1D.py", line 432, in examples.elphf.phaseDiffusion.input1D
Failed example:
    allclose(ends, (0.3, 0.4), rtol = 3e-3, atol = 3e-3)
Expected:
    1
Got:
    False
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/elphf/phaseDiffusion/input1D.py", line 435, in examples.elphf.phaseDiffusion.input1D
Failed example:
    allclose(ends, (0.1, 0.2), rtol = 3e-3, atol = 3e-3)
Expected:
    1
Got:
    False


======================================================================
FAIL: Doctest: examples.elphf.poisson.input1D
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for examples.elphf.poisson.input1D
  File "/home/username/tmp/fipy-current/examples/elphf/poisson/input1D.py", line 6, in input1D

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/elphf/poisson/input1D.py", line 109, in examples.elphf.poisson.input1D
Failed example:
    potential.equation.solve(var = potential, 
                             boundaryConditions = bcs)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.elphf.poisson.input1D[18]>", line 2, in ?
        boundaryConditions = bcs)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/elphf/poisson/input1D.py", line 123, in examples.elphf.poisson.input1D
Failed example:
    print potential.allclose(analyticalArray, rtol = 2e-5, atol = 2e-5)
Expected:
    1
Got:
    False
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/elphf/poisson/input1D.py", line 152, in examples.elphf.poisson.input1D
Failed example:
    potential.equation.solve(var = potential, 
                             boundaryConditions = bcs)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.elphf.poisson.input1D[26]>", line 2, in ?
        boundaryConditions = bcs)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/elphf/poisson/input1D.py", line 170, in examples.elphf.poisson.input1D
Failed example:
    potential.allclose(analyticalArray, rtol = 2e-5, atol = 2e-5).getValue()
Expected:
    1
Got:
    False
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/elphf/poisson/input1D.py", line 196, in examples.elphf.poisson.input1D
Failed example:
    potential.equation.solve(var = potential, 
                             boundaryConditions = bcs)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.elphf.poisson.input1D[33]>", line 2, in ?
        boundaryConditions = bcs)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/elphf/poisson/input1D.py", line 213, in examples.elphf.poisson.input1D
Failed example:
    potential.allclose(analyticalArray, rtol = 2e-5, atol = 2e-5).getValue()
Expected:
    1
Got:
    False


======================================================================
FAIL: Doctest: examples.levelSet.surfactant.inputCircle
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for examples.levelSet.surfactant.inputCircle
  File "/home/username/tmp/fipy-current/examples/levelSet/surfactant/inputCircle.py", line 6, in inputCircle

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/levelSet/surfactant/inputCircle.py", line 30, in examples.levelSet.surfactant.inputCircle
Failed example:
    for step in range(steps):
        surfactantVariable.updateOld()
        distanceVariable.updateOld()
        surfactantEquation.solve(surfactantVariable)
        advectionEquation.solve(distanceVariable, dt = timeStepDuration)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.levelSet.surfactant.inputCircle[1]>", line 4, in ?
        surfactantEquation.solve(surfactantVariable)
      File "/home/username/tmp/fipy-current/fipy/models/levelSet/surfactant/surfactantEquation.py", line 96, in solve
        solver = solver)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 66, in _buildMatrix
        termMatrix, termRHSvector = self.term2._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/faceTerm.py", line 173, in _buildMatrix
        self._explicitBuildMatrix(var.getOld(), id1, id2, b, weight['explicit'], mesh, boundaryConditions, interiorFaces, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/faceTerm.py", line 100, in _explicitBuildMatrix
        b -= LL * numerix.array(oldArray)
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 227, in __mul__
        self.matrix.matvec(other, y)
    TypeError: argument 1 must be array, not numpy.ndarray
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/levelSet/surfactant/inputCircle.py", line 35, in examples.levelSet.surfactant.inputCircle
Failed example:
    surfactantEquation.solve(surfactantVariable)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.levelSet.surfactant.inputCircle[2]>", line 1, in ?
        surfactantEquation.solve(surfactantVariable)
      File "/home/username/tmp/fipy-current/fipy/models/levelSet/surfactant/surfactantEquation.py", line 96, in solve
        solver = solver)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 66, in _buildMatrix
        termMatrix, termRHSvector = self.term2._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/faceTerm.py", line 173, in _buildMatrix
        self._explicitBuildMatrix(var.getOld(), id1, id2, b, weight['explicit'], mesh, boundaryConditions, interiorFaces, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/faceTerm.py", line 100, in _explicitBuildMatrix
        b -= LL * numerix.array(oldArray)
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 227, in __mul__
        self.matrix.matvec(other, y)
    TypeError: argument 1 must be array, not numpy.ndarray
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/levelSet/surfactant/inputCircle.py", line 48, in examples.levelSet.surfactant.inputCircle
Failed example:
    print numerix.sqrt(error / size)
Expected:
    0.00813776069241
Got:
    0.4


======================================================================
FAIL: Doctest: examples.levelSet.surfactant.inputSquare
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for examples.levelSet.surfactant.inputSquare
  File "/home/username/tmp/fipy-current/examples/levelSet/surfactant/inputSquare.py", line 6, in inputSquare

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/levelSet/surfactant/inputSquare.py", line 16, in examples.levelSet.surfactant.inputSquare
Failed example:
    for step in range(steps):
        surfactantVariable.updateOld()
        distanceVariable.updateOld()
        surfactantEquation.solve(surfactantVariable)
        advectionEquation.solve(distanceVariable, dt = timeStepDuration)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.levelSet.surfactant.inputSquare[2]>", line 4, in ?
        surfactantEquation.solve(surfactantVariable)
      File "/home/username/tmp/fipy-current/fipy/models/levelSet/surfactant/surfactantEquation.py", line 96, in solve
        solver = solver)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 66, in _buildMatrix
        termMatrix, termRHSvector = self.term2._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/faceTerm.py", line 173, in _buildMatrix
        self._explicitBuildMatrix(var.getOld(), id1, id2, b, weight['explicit'], mesh, boundaryConditions, interiorFaces, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/faceTerm.py", line 100, in _explicitBuildMatrix
        b -= LL * numerix.array(oldArray)
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 227, in __mul__
        self.matrix.matvec(other, y)
    TypeError: argument 1 must be array, not numpy.ndarray


======================================================================
FAIL: Doctest: examples.levelSet.surfactant.expandingCircle
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for examples.levelSet.surfactant.expandingCircle
  File "/home/username/tmp/fipy-current/examples/levelSet/surfactant/expandingCircle.py", line 6, in expandingCircle

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/levelSet/surfactant/expandingCircle.py", line 30, in examples.levelSet.surfactant.expandingCircle
Failed example:
    for step in range(steps):
        velocity.setValue(surfactantVariable.getInterfaceVar() * k)
        distanceVariable.extendVariable(velocity)
        timeStepDuration = cfl * dx / numerix.max(velocity)
        distanceVariable.updateOld()
        advectionEquation.solve(distanceVariable, dt = timeStepDuration)
        surfactantEquation.solve(surfactantVariable)
        totalTime += timeStepDuration
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.levelSet.surfactant.expandingCircle[2]>", line 7, in ?
        surfactantEquation.solve(surfactantVariable)
      File "/home/username/tmp/fipy-current/fipy/models/levelSet/surfactant/surfactantEquation.py", line 96, in solve
        solver = solver)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 66, in _buildMatrix
        termMatrix, termRHSvector = self.term2._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/faceTerm.py", line 173, in _buildMatrix
        self._explicitBuildMatrix(var.getOld(), id1, id2, b, weight['explicit'], mesh, boundaryConditions, interiorFaces, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/faceTerm.py", line 100, in _explicitBuildMatrix
        b -= LL * numerix.array(oldArray)
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 227, in __mul__
        self.matrix.matvec(other, y)
    TypeError: argument 1 must be array, not numpy.ndarray
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/levelSet/surfactant/expandingCircle.py", line 38, in examples.levelSet.surfactant.expandingCircle
Failed example:
    surfactantEquation.solve(surfactantVariable)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.levelSet.surfactant.expandingCircle[3]>", line 1, in ?
        surfactantEquation.solve(surfactantVariable)
      File "/home/username/tmp/fipy-current/fipy/models/levelSet/surfactant/surfactantEquation.py", line 96, in solve
        solver = solver)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 66, in _buildMatrix
        termMatrix, termRHSvector = self.term2._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/faceTerm.py", line 173, in _buildMatrix
        self._explicitBuildMatrix(var.getOld(), id1, id2, b, weight['explicit'], mesh, boundaryConditions, interiorFaces, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/faceTerm.py", line 100, in _explicitBuildMatrix
        b -= LL * numerix.array(oldArray)
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 227, in __mul__
        self.matrix.matvec(other, y)
    TypeError: argument 1 must be array, not numpy.ndarray
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/levelSet/surfactant/expandingCircle.py", line 54, in examples.levelSet.surfactant.expandingCircle
Failed example:
    print numerix.sqrt(error / size) < 0.04
Expected:
    1
Got:
    False


======================================================================
FAIL: Doctest: examples.levelSet.surfactant.adsorption
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for examples.levelSet.surfactant.adsorption
  File "/home/username/tmp/fipy-current/examples/levelSet/surfactant/adsorption.py", line 6, in adsorption

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/levelSet/surfactant/adsorption.py", line 63, in examples.levelSet.surfactant.adsorption
Failed example:
    for i in range(totalTimeSteps):
        surfactantVar.updateOld()
        bulkVar.updateOld()
        surfEqn.solve(surfactantVar, dt = dt)
        bulkEqn.solve(bulkVar, dt = dt, boundaryConditions = bcs)
        currentTime += dt
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.levelSet.surfactant.adsorption[2]>", line 4, in ?
        surfEqn.solve(surfactantVar, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/models/levelSet/surfactant/adsorbingSurfactantEquation.py", line 369, in solve
        SurfactantEquation.solve(self, var, boundaryConditions = boundaryConditions, solver = solver, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/models/levelSet/surfactant/surfactantEquation.py", line 96, in solve
        solver = solver)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 66, in _buildMatrix
        termMatrix, termRHSvector = self.term2._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/faceTerm.py", line 173, in _buildMatrix
        self._explicitBuildMatrix(var.getOld(), id1, id2, b, weight['explicit'], mesh, boundaryConditions, interiorFaces, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/faceTerm.py", line 100, in _explicitBuildMatrix
        b -= LL * numerix.array(oldArray)
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 227, in __mul__
        self.matrix.matvec(other, y)
    TypeError: argument 1 must be array, not numpy.ndarray
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/levelSet/surfactant/adsorption.py", line 76, in examples.levelSet.surfactant.adsorption
Failed example:
    numerix.allclose(concentrationFunc(theta), bulkVar[1:], rtol = 1e-4)
Expected:
    1
Got:
    False


======================================================================
FAIL: Doctest: examples.levelSet.electroChem.inputWriteScriptHowTo
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for examples.levelSet.electroChem.inputWriteScriptHowTo
  File "/home/username/tmp/fipy-current/examples/levelSet/electroChem/inputWriteScriptHowTo.py", line 6, in inputWriteScriptHowTo

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/levelSet/electroChem/inputWriteScriptHowTo.py", line 452, in examples.levelSet.electroChem.inputWriteScriptHowTo
Failed example:
    for step in range(numberOfSteps):

        for viewer in viewers:
            viewer.plot()

        if step % levelSetUpdateFrequency == 0:
            distanceVar.calcDistanceFunction()

        extensionVelocityVariable.setValue(depositionRateVariable())

        distanceVar.updateOld()
        catalystVar.updateOld()
        metalVar.updateOld()
        bulkCatalystVar.updateOld()
        distanceVar.extendVariable(extensionVelocityVariable)
        dt = cflNumber * cellSize / max(extensionVelocityVariable)
        advectionEquation.solve(distanceVar, dt=dt)
        surfactantEquation.solve(catalystVar, dt=dt)
        metalEquation.solve(var=metalVar, dt=dt,
                            boundaryConditions=metalEquationBCs)
        bulkCatalystEquation.solve(var=bulkCatalystVar, dt=dt,
                                      boundaryConditions=catalystBCs)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.levelSet.electroChem.inputWriteScriptHowTo[69]>", line 18, in ?
        surfactantEquation.solve(catalystVar, dt=dt)
      File "/home/username/tmp/fipy-current/fipy/models/levelSet/surfactant/adsorbingSurfactantEquation.py", line 369, in solve
        SurfactantEquation.solve(self, var, boundaryConditions = boundaryConditions, solver = solver, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/models/levelSet/surfactant/surfactantEquation.py", line 96, in solve
        solver = solver)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 66, in _buildMatrix
        termMatrix, termRHSvector = self.term2._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/faceTerm.py", line 173, in _buildMatrix
        self._explicitBuildMatrix(var.getOld(), id1, id2, b, weight['explicit'], mesh, boundaryConditions, interiorFaces, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/faceTerm.py", line 100, in _explicitBuildMatrix
        b -= LL * numerix.array(oldArray)
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 227, in __mul__
        self.matrix.matvec(other, y)
    TypeError: argument 1 must be array, not numpy.ndarray
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/levelSet/electroChem/inputWriteScriptHowTo.py", line 491, in examples.levelSet.electroChem.inputWriteScriptHowTo
Failed example:
    print catalystVar.allclose(numerix.array(dump.read(filepath)), rtol=1e-4)
Expected:
    1
Got:
    False


======================================================================
FAIL: Doctest: examples.levelSet.electroChem.inputSimpleTrenchSystem
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for examples.levelSet.electroChem.inputSimpleTrenchSystem
  File "/home/username/tmp/fipy-current/examples/levelSet/electroChem/inputSimpleTrenchSystem.py", line 6, in inputSimpleTrenchSystem

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/levelSet/electroChem/inputSimpleTrenchSystem.py", line 39, in examples.levelSet.electroChem.inputSimpleTrenchSystem
Failed example:
    runSimpleTrenchSystem(numberOfSteps=5, displayViewers=False)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.levelSet.electroChem.inputSimpleTrenchSystem[1]>", line 1, in ?
        runSimpleTrenchSystem(numberOfSteps=5, displayViewers=False)
      File "/home/username/tmp/fipy-current/examples/levelSet/electroChem/inputSimpleTrenchSystem.py", line 363, in runSimpleTrenchSystem
        surfactantEquation.solve(catalystVar, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/models/levelSet/surfactant/adsorbingSurfactantEquation.py", line 369, in solve
        SurfactantEquation.solve(self, var, boundaryConditions = boundaryConditions, solver = solver, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/models/levelSet/surfactant/surfactantEquation.py", line 96, in solve
        solver = solver)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 66, in _buildMatrix
        termMatrix, termRHSvector = self.term2._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/faceTerm.py", line 173, in _buildMatrix
        self._explicitBuildMatrix(var.getOld(), id1, id2, b, weight['explicit'], mesh, boundaryConditions, interiorFaces, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/faceTerm.py", line 100, in _explicitBuildMatrix
        b -= LL * numerix.array(oldArray)
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 227, in __mul__
        self.matrix.matvec(other, y)
    TypeError: argument 1 must be array, not numpy.ndarray
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/levelSet/electroChem/inputSimpleTrenchSystem.py", line 54, in examples.levelSet.electroChem.inputSimpleTrenchSystem
Failed example:
    runSimpleTrenchSystem(catalystCoverage=0.1, displayViewers=False)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.levelSet.electroChem.inputSimpleTrenchSystem[2]>", line 1, in ?
        runSimpleTrenchSystem(catalystCoverage=0.1, displayViewers=False)
      File "/home/username/tmp/fipy-current/examples/levelSet/electroChem/inputSimpleTrenchSystem.py", line 363, in runSimpleTrenchSystem
        surfactantEquation.solve(catalystVar, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/models/levelSet/surfactant/adsorbingSurfactantEquation.py", line 369, in solve
        SurfactantEquation.solve(self, var, boundaryConditions = boundaryConditions, solver = solver, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/models/levelSet/surfactant/surfactantEquation.py", line 96, in solve
        solver = solver)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 66, in _buildMatrix
        termMatrix, termRHSvector = self.term2._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/faceTerm.py", line 173, in _buildMatrix
        self._explicitBuildMatrix(var.getOld(), id1, id2, b, weight['explicit'], mesh, boundaryConditions, interiorFaces, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/faceTerm.py", line 100, in _explicitBuildMatrix
        b -= LL * numerix.array(oldArray)
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 227, in __mul__
        self.matrix.matvec(other, y)
    TypeError: argument 1 must be array, not numpy.ndarray


======================================================================
FAIL: Doctest: examples.levelSet.electroChem.inputGold
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for examples.levelSet.electroChem.inputGold
  File "/home/username/tmp/fipy-current/examples/levelSet/electroChem/inputGold.py", line 6, in inputGold

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/levelSet/electroChem/inputGold.py", line 39, in examples.levelSet.electroChem.inputGold
Failed example:
    runGold(numberOfSteps=10, displayViewers=False)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.levelSet.electroChem.inputGold[1]>", line 1, in ?
        runGold(numberOfSteps=10, displayViewers=False)
      File "/home/username/tmp/fipy-current/examples/levelSet/electroChem/inputGold.py", line 155, in runGold
        overBumpWidth = 0.)
      File "/home/username/tmp/fipy-current/fipy/models/levelSet/electroChem/gapFillMesh.py", line 304, in __init__
        transitionRegionHeight = transitionHeight)
      File "/home/username/tmp/fipy-current/fipy/models/levelSet/electroChem/gapFillMesh.py", line 101, in __init__
        transitionMesh = self.buildTransitionMesh(nx, transitionRegionHeight, cellSize) + (0, self.actualFineRegionHeight)
      File "/home/username/tmp/fipy-current/fipy/models/levelSet/electroChem/gapFillMesh.py", line 173, in buildTransitionMesh
        mesh = GmshImporter2D(meshName)
      File "/home/username/tmp/fipy-current/fipy/meshes/numMesh/gmshImport.py", line 394, in __init__
        mesh2D.Mesh2D.__init__(self, **_DataGetter().getData(filename, dimensions = 2, coordDimensions = coordDimensions))
      File "/home/username/tmp/fipy-current/fipy/meshes/numMesh/gmshImport.py", line 263, in getData
        vertexCoords = self._calcVertexCoords(coordDimensions)
      File "/home/username/tmp/fipy-current/fipy/meshes/numMesh/gmshImport.py", line 286, in _calcVertexCoords
        numVertices = int(self.inFile.readline())
    ValueError: invalid literal for int(): 


======================================================================
FAIL: Doctest: examples.levelSet.electroChem.inputLeveler
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for examples.levelSet.electroChem.inputLeveler
  File "/home/username/tmp/fipy-current/examples/levelSet/electroChem/inputLeveler.py", line 6, in inputLeveler

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/levelSet/electroChem/inputLeveler.py", line 40, in examples.levelSet.electroChem.inputLeveler
Failed example:
    runLeveler(numberOfSteps=10, displayViewers=False, cellSize=0.25e-7)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.levelSet.electroChem.inputLeveler[1]>", line 1, in ?
        runLeveler(numberOfSteps=10, displayViewers=False, cellSize=0.25e-7)
      File "/home/username/tmp/fipy-current/examples/levelSet/electroChem/inputLeveler.py", line 260, in runLeveler
        overBumpWidth = 0.)
      File "/home/username/tmp/fipy-current/fipy/models/levelSet/electroChem/gapFillMesh.py", line 304, in __init__
        transitionRegionHeight = transitionHeight)
      File "/home/username/tmp/fipy-current/fipy/models/levelSet/electroChem/gapFillMesh.py", line 101, in __init__
        transitionMesh = self.buildTransitionMesh(nx, transitionRegionHeight, cellSize) + (0, self.actualFineRegionHeight)
      File "/home/username/tmp/fipy-current/fipy/models/levelSet/electroChem/gapFillMesh.py", line 173, in buildTransitionMesh
        mesh = GmshImporter2D(meshName)
      File "/home/username/tmp/fipy-current/fipy/meshes/numMesh/gmshImport.py", line 394, in __init__
        mesh2D.Mesh2D.__init__(self, **_DataGetter().getData(filename, dimensions = 2, coordDimensions = coordDimensions))
      File "/home/username/tmp/fipy-current/fipy/meshes/numMesh/gmshImport.py", line 263, in getData
        vertexCoords = self._calcVertexCoords(coordDimensions)
      File "/home/username/tmp/fipy-current/fipy/meshes/numMesh/gmshImport.py", line 286, in _calcVertexCoords
        numVertices = int(self.inFile.readline())
    ValueError: invalid literal for int(): 


======================================================================
FAIL: Doctest: examples.chemotaxis.input
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for examples.chemotaxis.input
  File "/home/username/tmp/fipy-current/examples/chemotaxis/input.py", line 6, in input

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/chemotaxis/input.py", line 13, in examples.chemotaxis.input
Failed example:
    for i in range(300):
        for var, eqn in eqs:
            var.updateOld()
        for var, eqn in eqs:
            eqn.solve(var, dt = 0.1)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.chemotaxis.input[0]>", line 5, in ?
        eqn.solve(var, dt = 0.1)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 66, in _buildMatrix
        termMatrix, termRHSvector = self.term2._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.


======================================================================
FAIL: Doctest: examples.chemotaxis.input2D
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for examples.chemotaxis.input2D
  File "/home/username/tmp/fipy-current/examples/chemotaxis/input2D.py", line 6, in input2D

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/chemotaxis/input2D.py", line 13, in examples.chemotaxis.input2D
Failed example:
    for i in range(300):
        for var, eqn in eqs:
            var.updateOld()
        for var, eqn in eqs:
            eqn.solve(var, dt = 0.1)
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.chemotaxis.input2D[0]>", line 5, in ?
        eqn.solve(var, dt = 0.1)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 66, in _buildMatrix
        termMatrix, termRHSvector = self.term2._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.


======================================================================
FAIL: Doctest: examples.cahnHilliard.inputTanh1D
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for examples.cahnHilliard.inputTanh1D
  File "/home/username/tmp/fipy-current/examples/cahnHilliard/inputTanh1D.py", line 6, in inputTanh1D

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/cahnHilliard/inputTanh1D.py", line 170, in examples.cahnHilliard.inputTanh1D
Failed example:
    for step in range(100):
        dt = numerix.exp(dexp)
        dt = min(10, dt)
        dexp += 0.5
        eqch.solve(var=var, boundaryConditions=BCs, solver=solver, dt=dt)
        if __name__ == '__main__':
            diff = abs(answer - numerix.array(var))
            maxarg = numerix.argmax(diff)
            print 'maximum error:',diff[maxarg]
            print 'element id:',maxarg
            print 'value at element ',maxarg,' is ',var[maxarg]
            print 'solution value',answer[maxarg]

            viewer.plot()
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.cahnHilliard.inputTanh1D[27]>", line 5, in ?
        eqch.solve(var=var, boundaryConditions=BCs, solver=solver, dt=dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 121, in solve
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 66, in _buildMatrix
        termMatrix, termRHSvector = self.term2._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/cahnHilliard/inputTanh1D.py", line 187, in examples.cahnHilliard.inputTanh1D
Failed example:
    print var.allclose(answer, atol=1e-4)
Expected:
    1
Got:
    False


======================================================================
FAIL: Doctest: examples.flow.stokesCavity
----------------------------------------------------------------------
Traceback (most recent call last):
  File "doctest.py", line 2157, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for examples.flow.stokesCavity
  File "/home/username/tmp/fipy-current/examples/flow/stokesCavity.py", line 6, in stokesCavity

----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/flow/stokesCavity.py", line 198, in examples.flow.stokesCavity
Failed example:
    for sweep in range(sweeps):

        ## solve the Stokes equations to get starred values
        xVelocityEq.cacheMatrix()
        xres = xVelocityEq.sweep(var=xVelocity,
                                 boundaryConditions=bcsX,
                                 underRelaxation=velocityRelaxation)
        xmat = xVelocityEq.getMatrix()

        yres = yVelocityEq.sweep(var=yVelocity,
                                 boundaryConditions=bcsY,
                                 underRelaxation=velocityRelaxation)

        ## update the ap coefficient from the matrix diagonal
        ap[:] = -xmat.takeDiagonal()

        ## update the face velocities based on starred values
        velocity[:,0] = xVelocity.getArithmeticFaceValue()
        velocity[:,1] = yVelocity.getArithmeticFaceValue()
        for id in mesh.getExteriorFaces():
            velocity[id,:] = 0.

        ## solve the pressure correction equation
        pressureCorrectionEq.cacheRHSvector()
        pres = pressureCorrectionEq.sweep(var=pressureCorrection)
        rhs = pressureCorrectionEq.getRHSvector()

        ## update the pressure using the corrected value but hold one cell fixed
        pressure.setValue(pressure + pressureRelaxation * \
                                               (pressureCorrection - pressureCorrection[0]))
        ## update the velocity using the corrected pressure
        xVelocity.setValue(xVelocity - pressureCorrection.getGrad()[:,0] / \
                                                   ap * mesh.getCellVolumes())
        yVelocity.setValue(yVelocity - pressureCorrection.getGrad()[:,1] / \
                                                   ap * mesh.getCellVolumes())

        if __name__ == '__main__':
            if sweep%1 == 0:
                print 'sweep:',sweep,', x residual:',xres, \
                                     ', y residual',yres, \
                                     ', p residual:',pres, \
                                     ', continuity:',max(abs(rhs))

                viewer.plot()
Exception raised:
    Traceback (most recent call last):
      File "doctest.py", line 1248, in __run
        compileflags, 1) in test.globs
      File "<doctest examples.flow.stokesCavity[27]>", line 7, in ?
        underRelaxation=velocityRelaxation)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 142, in sweep
        matrix, RHSvector = self.__buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/term.py", line 88, in __buildMatrix
        return self._buildMatrix(var, boundaryConditions, dt)
      File "/home/username/tmp/fipy-current/fipy/terms/binaryTerm.py", line 64, in _buildMatrix
        matrix, RHSvector = self.term1._buildMatrix(var, boundaryConditions, dt = dt)
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 272, in _buildMatrix
        self._getCoefficientMatrix(mesh, self.coeffDict['cell 1 diag']), numerix.zeros(N,'d'))
      File "/home/username/tmp/fipy-current/fipy/terms/diffusionTerm.py", line 178, in _getCoefficientMatrix
        coefficientMatrix.addAt(interiorCoeff, interiorFaceCellIDs[...,0], interiorFaceCellIDs[...,1])
      File "/home/username/tmp/fipy-current/fipy/tools/sparseMatrix.py", line 322, in addAt
        self.matrix.update_add_at(vector, id1, id2)
    TypeError: No array interface and __array__ method not returning Numeric array.
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/flow/stokesCavity.py", line 257, in examples.flow.stokesCavity
Failed example:
    numerix.allclose(pressure[-1], 145.233883763)
Expected:
    1
Got:
    False
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/flow/stokesCavity.py", line 259, in examples.flow.stokesCavity
Failed example:
    numerix.allclose(xVelocity[-1], 0.24964673696)
Expected:
    1
Got:
    False
----------------------------------------------------------------------
File "/home/username/tmp/fipy-current/examples/flow/stokesCavity.py", line 261, in examples.flow.stokesCavity
Failed example:
    numerix.allclose(yVelocity[-1], -0.164498041783)
Expected:
    1
Got:
    False


----------------------------------------------------------------------
Ran 417 tests in 37.951s

FAILED (failures=64)
